<div class="containsAtoolbar">
	<kendo-toolbar class="small" style="background-color: #f5f6fa;">
		<kendo-toolbar-button [text]="'Create Groups for a Coding Tool'" (click)="RandomlyAssign()" [attr.aria-expanded]="!RandomlyAssignSection" ></kendo-toolbar-button>
		<!--<kendo-toolbar-button [text]="'Create New Code'"  (click)="NewCode()" [attr.aria-expanded]="!NewCodeSection" ></kendo-toolbar-button>-->
		<kendo-toolbar-button [text]="'Create New Work Allocation'" (click)="NewWorkAllocation()" [attr.aria-expanded]="!AssignWorkSection"></kendo-toolbar-button>
	</kendo-toolbar>
</div>
<!--<kendo-splitter-pane>-->
	<div id="RandomlyAssignSection" *ngIf="RandomlyAssignSection" class="col-12 col-sm-12 col-md-12 p-0 mb-1" style="min-width:120px;">
		<div class="card container-fluid mt-1 bg-light border border-primary rounded m-1 p-1">
			<div class="card-body alert-info">
				<div class="row bg-light ">
					<div class="col-md-2"></div>
					<div class="col-12  col-sm-10  col-md-10 row">
						<div class="col-2 text-right" style="min-width: 80px;">Select From </div>
						<div class="form-group col-12  col-sm-8  col-sm-8" >
							<select  
									#AllocateOptionsDropDown class="form-control" name="AllocateOptions"
									style="min-width: 200px;" (change)="SetRelevantDropDownValues()"
									(click)="isCollapsedAllocateOptions = false; isCollapsedCodingTool = false">
								<option *ngFor="let item of AllocateOptions" [value]="item.key"
										[selected]="item.selected == item.value || 'No code / coding tool filter'">
									{{item.value}}
								</option>
							</select>
						</div>
					</div>
					<div class="col d-flex justify-content-center"></div>
				</div>
				<div class="row bg-light ">
					<div class="col-0 col-sm-2 col-md-2">
					</div>
					<div class="col-10 row p-1"
						 *ngIf="(selectedRandomAllocateDropDown == 'All with this code')
						||  (selectedRandomAllocateDropDown == 'All without this code' )">

						<div class="col-2  text-right" >
							Select also from
						</div>

						<div ngbDropdown class="col-12 col-sm-8 col-md-8">
							<button ngbDropdownAnchor class="btn btn-outline-secondary dropdown-toggle col-12"
									id="dropdownTreeRandomAllocate"
									(click)="isCollapsedAllocateOptions = !isCollapsedAllocateOptions; dropdownTree11 = false; isCollapsedCodingTool = false"
									[attr.aria-expanded]="!isCollapsedAllocateOptions" aria-controls="collapseCodeTreeWithWithout">
								{{DropdownWithWithoutSelectedCode?.name}}
							</button>
							<div ngbDropdownMenu class="dropdown-menu" id="collapseCodeTreeWithWithout" [ngbCollapse]="!isCollapsedAllocateOptions">
								<codesetSelector [IsMultiSelect]="false"
												 [WhatIsSelectable]="'SetAttribute'" [MaxHeight]="500" #WithOrWithoutCode
												 (selectedNodeInTree)="CloseCodeDropDownCodeWithWithout()"
												 [rootsOnly]="!CanOnlySelectRoots()"></codesetSelector>
							</div>
						</div>
					</div>
					<div class="col-10 row p-1 "
						 *ngIf="(selectedRandomAllocateDropDown == 'All with any codes from this coding tool')
						||  (selectedRandomAllocateDropDown == 'All without any codes from this coding tool' )">
						<!--<div class="col-0 col-sm-2 col-md-2">
						</div>-->
						<div class="col-2  text-right" style="min-width:100px;">
							Select also from
						</div>
						<div ngbDropdown class="col-8" style="min-width:200px;">
							<button class="btn btn-outline-secondary dropdown-toggle col-12"
									(click)="isCollapsedAllocateOptions = false; isCollapsedCodingTool = false; isCollapsedCodeStudies = false;"
									id="dropdownBasicCodingTool" ngbDropdownToggle>
								{{selectedCodeSetDropDown.name}}
							</button>
							<div ngbDropdownMenu aria-labelledby="dropdownBasicCodingTool">
								<button (click)="setCodeSetDropDown(item)"
										*ngFor="let item of CodeSets;" class="dropdown-item">
									{{item.name}}
								</button>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-0 col-md-2"></div>
					<div class="col-10 row p-1">
						<div class="col-2  text-right" style="min-width:110px;">
							Percentage to Allocate
						</div>
						<div class="col-4">
							<kendo-numerictextbox [(ngModel)]="numericRandomSample"
												  [min]="1" [format]="'n0'"
												  [max]="100"
												  [step]="1"
												  [autoCorrect]="true"
												  class="border border-dark rounded"
												  style="width: 100px;">

							</kendo-numerictextbox>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-0 col-md-2"></div>
					<div class="col-10 row p-1">
						<div class="col-2  text-right" style="min-width:110px;">
							Groups to create
						</div>
						<div class="col-4">
							<kendo-numerictextbox [(ngModel)]="numericRandomCreate"
												  [min]="1" [format]="'n0'"
												  [max]="10"
												  [step]="1"
												  [autoCorrect]="true"
												  class="border border-dark rounded"
												  style="width: 100px;">
							</kendo-numerictextbox>
						</div>

					</div>

				</div>
				<div class="row">
					<div class="col-0 col-sm-2 col-md-2"></div>
					<div class="col-12 col-md-10 row">
						<div class="col-12 col-md-3 " style="min-width:100px;">
							Inc / Exc
						</div>
						<div class="col-12 col-md-9 row">
							<input type="radio" value="true" [(ngModel)]="allocateInclOrExcl">
							<div class="col-12 col-md-4" style="min-width:100px;">&nbsp; Included </div>
							<input type="radio" value="false" [(ngModel)]="allocateInclOrExcl">
							<div class="col-12 col-md-4" style="min-width:80px;">&nbsp; Excluded</div>
						</div>
					</div>
				</div>
				<div class="row bg-light">
					<div class="col-0 col-md-2"></div>
					<div class="col-12 col-sm-10 col-md-10 row">
						<div class="col-12 col-sm-2 col-md-2  text-right" style="min-width:110px;">
							Create codes below this code / coding tool
						</div>
						<!--	dpAnchorDropDown -->
						<div ngbDropdown class="col-12 col-md-8" style="min-width:150px;">
							<button ngbDropdownAnchor class="btn btn-outline-primary dropdown-toggle
										col-12" id="dropdownTree11"
									(click)="isCollapsedCodingTool = !isCollapsedCodingTool; dropdownBasicCodingTool = false; isCollapsedAllocateOptions = false"
									[attr.aria-expanded]="!isCollapsedCodingTool"
									aria-controls="collapseCodeTreeCodingTool">
								{{DropdownSelectedCodingTool?.name}}
							</button>
							<div class="dropdown-menu " id="collapseCodeTreeCodingTool" 
								 [ngbCollapse]="!isCollapsedCodingTool">
								<codesetSelector [IsMultiSelect]="false" [WhatIsSelectable]="'Admin'"
												 [MaxHeight]="500" #CodingToolTree
												 (selectedNodeInTree)="CloseCodeDropDownCodingTool()"
												 [rootsOnly]="!CanOnlySelectRoots()"></codesetSelector>
							</div>
						</div>
					</div>
				</div>
				<div class="row bg-light">
					<div class="col-0  col-md-2"></div>
					<div class="col-12 col-sm-10 col-md-10 row">
						<div class="col-2  text-right" style="min-width:100px;">Assign / Cancel </div>
						<div class="form-group col-12 col-md-8  text-right">
							<button style="min-width:100px"
									class="col-12 col-md-4 pt-2 m-2 border border-dark rounded k-widget
								k-numerictextbox btn btn-success" [disabled]="!CanAssign()"
									(click)="Assignment()">
								Assign
							</button>
							<button style="min-width:100px"
									class="col-12 col-md-6 pt-2 m-2 border border-dark rounded
								k-widget k-numerictextbox btn btn-outline-dark "
									(click)="CloseRandomlyAssignSection()">
								Cancel
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="AssignWorkSection" *ngIf="AssignWorkSection" class="col-12 p-0 mb-1">
		<div class="card container-fluid mt-1 bg-light border border-primary rounded m-1 p-1">
			<div class="col-12 col-md-12">
				<div class="form-group col-md-8 row ">
					<div class="col-12 col-md-3  text-right" style="min-width:100px;">
						Code studies in this group:
					</div>
					<div ngbDropdown class="col-12 col-md-8" style="min-width:150px;">
						<button ngbDropdownAnchor class="btn btn-primary dropdown-toggle col-12 p-2 m-2" id="dropdownTree3"
								(click)="isCollapsedCodeStudies = !isCollapsedCodeStudies;"
								[attr.aria-expanded]="!isCollapsedCodeStudies" 
								aria-controls="collapseCodeTreeCodeStudies" style="min-width: 50px;"
								>
							{{DropdownSelectedCodeStudies?.name}}
						</button>
						<div ngbDropdownMenu class="dropdown-menu"
							 id="collapseCodeTreeCodeStudies"
							 [ngbCollapse]="!isCollapsedCodeStudies">
							<codesetSelector [IsMultiSelect]="false"
											 [WhatIsSelectable]="'SetAttribute'" [MaxHeight]="500" #CodeStudiesTree
											 (selectedNodeInTree)="CloseCodeDropDownStudies()"
											 [rootsOnly]="!CanOnlySelectRoots()">
							</codesetSelector>
						</div>
					</div>
				</div>
				<div class="form-group col-md-8 row ">
					<div class="col-12 col-md-3  text-right" style="min-width:100px;">
						Using this codeset:
					</div>
					<div ngbDropdown class="col-12 col-md-8" style="min-width:150px;">
						<button class="btn btn-primary col-12  p-2 m-2" id="dropdownBasicCodingTool" ngbDropdownToggle>
							{{DropDownBasicCodingTool.name}}
						</button>
						<div ngbDropdownMenu aria-labelledby="dropdownBasicCodingTool">
							<button (click)="setCodeSetDropDown2(item);"
									*ngFor="let item of CodeSets;" class="dropdown-item">
								{{item.name}}
							</button>
						</div>
					</div>
				</div>
				<div class="form-group col-md-8 row">
					<div class="col-12 col-md-3  text-right" style="min-width:100px;">
						To this person:
					</div>
					<div ngbDropdown class="col-12 col-md-8" style="min-width:150px;">
						<button class="btn btn-primary col-12  p-2 m-2" id="dropdownBasicPerson" ngbDropdownToggle>
							{{selectedMemberDropDown.contactName}}
						</button>
						<div ngbDropdownMenu aria-labelledby="dropdownBasicPerson">
							<button (click)="SetMemberDropDown(member); "
									*ngFor="let member of reviewInfoService.Contacts" class="dropdown-item">
								{{member.contactName}}
							</button>
						</div>
					</div>
				</div>
				<div class="col-md-8 row">
					<div class="col-md-4"></div>
					<div class="form-group col-md-8 row">
						<button class="btn btn-outline-success col-12 col-md-3 p-3 m-3" [disabled]="CanNewWorkAllocationCreate()" (click)="WorkAssignment()" style="min-width:150px;">Assign</button>
						<button class="btn btn-outline-dark col-12 col-md-3 p-3 m-3" (click)="CloseAssignSection()" style="min-width:150px;">Cancel</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="NewCodeSection" *ngIf="NewCodeSection" class="col-12 col-md-12 p-0 mb-1">
		<div class="card container-fluid mt-1 bg-light border border-primary rounded m-1 p-1 form-group">
			<div class="font-weight-bold col-md-4">Code Name</div>
			<input pattern="^(?!\s*$).+" [(ngModel)]="codeName"
				   #codeNameModel="ngModel"
				   id="codeNameModel" name="codeNameModel"
				   required minlength="3"
				   type="text"
				   placeholder="codeName"
				   class="col-md-4 form-control" />

			<div *ngIf="codeNameModel.invalid && (codeNameModel.dirty || codeNameModel.touched)"
				 class="alert alert-danger">

				<div *ngIf="codeNameModel.errors.pattern">
					Cannot be empty
				</div>

				<div *ngIf="codeNameModel.errors.required">
					code name  is required.
				</div>
				<div *ngIf="codeNameModel.errors.minlength">
					code name must be at least 3 characters long.
				</div>
			</div>

			<div class="font-weight-bold col-md-4">Description</div>
			<textarea pattern="^(?!\s*$).+" [(ngModel)]="description"
					  #descriptionModel="ngModel"
					  id="descriptionModel" name="descriptionModel"
					  required minlength="3"
					  placeholder="Description" class="col-md-4 form-control"></textarea>
			<div *ngIf="descriptionModel.invalid && (descriptionModel.dirty || descriptionModel.touched)"
				 class="alert alert-danger">

				<div *ngIf="descriptionModel.errors.pattern">
					Cannot be empty
				</div>

				<div *ngIf="descriptionModel.errors.required">
					description is required.
				</div>
				<div *ngIf="descriptionModel.errors.minlength">
					description must be at least 3 characters long.
				</div>

			</div>
			<div class="font-weight-bold col-md-4">Code Type</div>
			<div ngbDropdown class="col-12 col-md-4 pr-1 pl-1">
				<button class="btn btn-primary col-12 p-2 m-2" id="dropdownBasicNewCode"
						ngbDropdownToggle>
					{{selectedCodeSetDropDown}}
				</button>
				<div ngbDropdownMenu aria-labelledby="dropdownBasicNewCode">
					<button (click)="setCodeSetDropDown(item)"
							*ngFor="let item of CodeSets;" class="dropdown-item">
						{{item}}
					</button>
				</div>
			</div>
			<div class="font-weight-bold col-md-4">Index Number</div>
			<input type="text" name="indexNumber" class="col-md-4  form-control" />
			<div class="row col-md-4">
				<div class="col-md-6">
					<button type="submit" class="btn btn-info p-2 m-2" style="min-width:162px;max-width:162px;">Save</button>
				</div>
				<div class="col-md-6">
					<button type="submit" class="btn btn-danger p-2 m-2" style="min-width:162px;max-width:162px;">Cancel</button>
				</div>
			</div>
		</div>
	</div>
	<div class="col-12 p-0 mb-1 bg-light" style="min-height:300px;">
		<div class="col-12 row p-0 m-0">
			<div class="card  col-sm-12 col-md-3 px-1">
				<h5 class="m-1 p-1 font-weight-bold">Reviewers</h5>
				<div style="max-height:340px;overflow:auto;">
					<table class='card-body table table-striped bg-light' *ngIf="_workAllocationListService.ContactWorkAllocations">
						<thead>
							<tr class="small">
								<th>ID</th>
								<th>Name</th>
							</tr>
						</thead>
						<tbody>
							<tr class="small" *ngFor="let member of reviewInfoService.Contacts; let i = index">
								<td>{{ member.contactId }}</td>
								<td>{{ member.contactName }}</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="card col-sm-12 col-md-9 px-1 ">
				<h5 class="m-1 p-1 font-weight-bold"> Coding Assignments</h5>
				<div style="max-height:340px;overflow:auto;">
					<table class='small table table-striped bg-light' *ngIf="_workAllocationListService.AllWorkAllocationsForReview">
						<thead>
							<tr>
								<th>ID</th>
								<th>Contact</th>
								<th>Study Group</th>
								<th>Codes to apply</th>
								<th>Allocated</th>
								<th>Started</th>
								<th>Remaining</th>
								<th>Delete</th>
							</tr>
						</thead>
						<tbody>
							<tr class="" *ngFor="let wa of _workAllocationListService.AllWorkAllocationsForReview; let i = index">
								<td>{{ wa.contactId }}</td>
								<td>{{ wa.contactName }}</td>
								<td>{{ wa.attributeName }}</td>
								<td>{{wa.setName}}</td>
								<td class="p-0" id="waAll-{{wa.workAllocationId}}" [ngClass]="{'UsedWorkAllocation' : 'waAll-'+ wa.workAllocationId == this.clickedIndex}" (click)="LoadGivenList(wa.workAllocationId,'GetItemWorkAllocationList')"><div class="btn btn-link mt-1">{{ wa.totalAllocation}}</div></td>
								<td class="p-0 " id="waStarted-{{wa.workAllocationId}}" [ngClass]="{'UsedWorkAllocation' : 'waAll-'+ wa.workAllocationId == this.clickedIndex}" (click)="LoadGivenList(wa.workAllocationId,'GetItemWorkAllocationListStarted')"><div class="btn btn-link mt-1">{{ wa.totalStarted}}</div></td>
								<td class="p-0" id="waRemaining-{{wa.workAllocationId}}" [ngClass]="{'UsedWorkAllocation' : 'waAll-'+ wa.workAllocationId == this.clickedIndex}" (click)="LoadGivenList(wa.workAllocationId,'GetItemWorkAllocationListRemaining')"><div class="btn btn-link mt-1">{{ wa.totalRemaining}}</div></td>
								<td class="p-0"><button class="btn btn-danger p-1 m-1" (click)="removeWarning(wa.workAllocationId)">Delete</button></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
