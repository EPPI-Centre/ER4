<div class="containsAtoolbar">
	<kendo-toolbar class="small" style="background-color: #f5f6fa;">
		<kendo-toolbar-button [text]="'Randomly assign code to item'" (click)="RandomlyAssign()" [attr.aria-expanded]="!RandomlyAssignSection" ></kendo-toolbar-button>
		<!--<kendo-toolbar-button [text]="'Create New Code'"  (click)="NewCode()" [attr.aria-expanded]="!NewCodeSection" ></kendo-toolbar-button>-->
		<kendo-toolbar-button [text]="'Create New Work Allocation'" (click)="NewWorkAllocation()" [attr.aria-expanded]="!AssignWorkSection"></kendo-toolbar-button>
	</kendo-toolbar>
</div>
<div id="RandomlyAssignSection" *ngIf="RandomlyAssignSection" class="col-12 p-0 mb-1">
	
	<div class="card container-fluid mt-1 bg-light border border-primary rounded m-1 p-1">

		<div class="card-body alert-info">
			<div class="row bg-light ">
				<div class="col">
					<div class="row pt-4">
						<div class="col">
							<button class="pt-2 m-2 border border-dark rounded k-widget 
									k-numerictextbox btn btn-success" [disabled]="!CanAssign()" 
									(click)="Assignment()">Assign</button>
						</div>
						<div class="col">
							<button class="pt-2 m-2 border border-dark rounded 
									k-widget k-numerictextbox btn btn-outline-dark" 
									(click)="CloseRandomlyAssignSection()">Cancel</button>
						</div>
					</div>
				</div>
				<div class="col">
					<div class="pl-2 mb-2">Select From </div>
					<div class="form-group pl-1">
						<select #SelectFrom class="form-control" name="AllocateOptions"
								style="min-width: 250px;" (change)="SetRelevantDropDownValues()"
								(click)="isCollapsed = false; isCollapsed2 = false">
							<option *ngFor="let item of AllocateOptions" [value]="item.key"
									[selected]="AllocateOptions && item.key == AllocateOptions[0].key">
								{{item.value}}
							</option>
						</select>
					</div>
				</div>
				<div class="col d-flex justify-content-center"></div>
			</div>
			<div class="row bg-light ">
				<div class="col d-flex">
					<div class="row p-1 m-1">
						<div class="col d-flex justify-content-center" style="width: 110px;">
							Percentage to Allocate
						</div>
						<div  class="col d-flex justify-content-center">
							<kendo-numerictextbox [(ngModel)]="numericRandomSample"
												  [min]="1" [format]="'n0'"
												  [max]="100"
												  [step]="1"
												  [autoCorrect]="true"
												  class="border border-dark rounded"
												   style="width: 100px;">

							</kendo-numerictextbox>
						</div>
					</div>
					<div class="row p-1 m-1">
						<div class="col d-flex justify-content-center" style="width: 110px;">
							Groups to create
						</div>
						<div class="col d-flex justify-content-center">
							<kendo-numerictextbox [(ngModel)]="numericRandomCreate"
												  [min]="1" [format]="'n0'"
												  [max]="10"
												  [step]="1"
												  [autoCorrect]="true"
												  class="border border-dark rounded"
												  style="width: 100px;">

							</kendo-numerictextbox>
						</div>
					</div>
				</div>
				<div class="col">
						
				</div>
			</div>
			<div class="row bg-light">
				<div class="col">
					<div class="row col-12 p-4" >
					
							<input type="radio" value="true" [(ngModel)]="allocateInclOrExcl">
							<div class="col " >&nbsp; Included </div>
					
				
							<input type="radio" value="false" [(ngModel)]="allocateInclOrExcl">
							<div class="col " >&nbsp; Excluded</div>
				
					
					</div>
				</div>
				<div class="col">

					<div class="col-12" *ngIf="(selectedRandomAllocateDropDown == 'All with this code')
					||  (selectedRandomAllocateDropDown == 'All without this code' )"></div>

						<div class="col-12 pr-1 pl-1"
							 *ngIf="(selectedRandomAllocateDropDown == 'All with this code')
					||  (selectedRandomAllocateDropDown == 'All without this code' )">
							<div ngbDropdown style="min-width: 200px;">
								<button ngbDropdownAnchor class="btn btn-primary dropdown-toggle col-12"
										id="dropdownTree10"
										(click)="isCollapsed = !isCollapsed; dropdownTree11 = false; isCollapsed2 = false"
										[attr.aria-expanded]="!isCollapsed" aria-controls="collapseCodeTree10">
									{{CurrentDropdownSelectedCode?.name}}
								</button>
								<div ngbDropdownMenu class="dropdown-menu" id="collapseCodeTree10" [ngbCollapse]="!isCollapsed">
									<codesetSelector [IsMultiSelect]="false"
													 [WhatIsSelectable]="'SetAttribute'" [MaxHeight]="500" #WithOrWithoutCode1
													 (selectedNodeInTree)="CloseCodeDropDown()"
													 [rootsOnly]="!CanOnlySelectRoots()"></codesetSelector>
								</div>
							</div>
						</div>

						<div ngbDropdown class="col-12 pr-1 pl-1" style="min-width: 200px;"
							 *ngIf="(selectedRandomAllocateDropDown == 'All with any codes from this coding tool')
						||  (selectedRandomAllocateDropDown == 'All without any codes from this coding tool' )">
							<button (click)="isCollapsed = false; isCollapsed2 = false; isCollapsed3 = false;"
									class="btn btn-primary col-12 col-md-12" id="dropdownBasic2" ngbDropdownToggle>
								{{selectedCodeSetDropDown.name}}
							</button>
							<div ngbDropdownMenu aria-labelledby="dropdownBasic2">
								<button (click)="setCodeSetDropDown(item)"
										*ngFor="let item of CodeSets;" class="dropdown-item">
									{{item.name}}
								</button>
							</div>
						</div>

						<div class="col-12 col-md-12"
							 *ngIf="(selectedRandomAllocateDropDown != 'All with any codes from this  coding tool')
						||  (selectedRandomAllocateDropDown != 'All without any codes from this  coding tool' )">
						</div>

						<div ngbDropdown class="col-12 pr-1 pl-1"  style="min-width: 200px;">
							<div class="mb-2">
								Create codes below this code / coding tool
							</div>
							<button ngbDropdownAnchor
									class="btn btn-primary dropdown-toggle col-12 col-md-12" id="dropdownTree11"
									(click)="isCollapsed2 = !isCollapsed2; dropdownBasic2 = false; isCollapsed = false"
									[attr.aria-expanded]="!isCollapsed2"
									aria-controls="collapseCodeTree11">
								{{CurrentDropdownSelectedCode2?.name}}
							</button>
							<div ngbDropdownMenu class="dropdown-menu pl-2" id="collapseCodeTree11" [ngbCollapse]="!isCollapsed2">
								<codesetSelector [IsMultiSelect]="false" [WhatIsSelectable]="''"
												 [MaxHeight]="500" #WithOrWithoutCode2
												 (selectedNodeInTree)="CloseCodeDropDown2()"
												 [rootsOnly]="!CanOnlySelectRoots()"></codesetSelector>
							</div>
						</div>

					</div>
					<div class="col d-flex justify-content-center">

					</div>
				</div>
		</div>
	</div>
</div>

<div id="AssignWorkSection" *ngIf="AssignWorkSection" class="col-12 p-0 mb-1">
	<div class="card container-fluid mt-1 bg-light border border-primary rounded m-1 p-1">
		<div class="col-12 col-md-12">
			<div class="form-group col-md-8 row ">
				<div class="col-12 col-sm-12 col-md-3" style="min-width:200px;">
					Code studies in this group:
				</div>
				<div ngbDropdown class="col-12 col-md-8" style="min-width:150px;">
					<button  class="btn btn-primary dropdown-toggle col-12 p-2 m-2" id="dropdownTree3"
							(click)="isCollapsed3 = !isCollapsed3;"
							[attr.aria-expanded]="!isCollapsed3" aria-controls="collapseCodeTree3" style="min-width: 50px;" ngbDropdownToggle>
						{{CurrentDropdownSelectedCode3?.name}}
					</button>
					<div ngbDropdownMenu class="dropdown-menu"
						 id="collapseCodeTree3" 
						 [ngbCollapse]="!isCollapsed3">
						<codesetSelector [IsMultiSelect]="false"
										 [WhatIsSelectable]="'SetAttribute'" [MaxHeight]="500" #WithOrWithoutCode3
										 (selectedNodeInTree)="CloseCodeDropDown3()"
										 [rootsOnly]="!CanOnlySelectRoots()">
						</codesetSelector>
					</div>
				</div>
			</div>
			<div class="form-group col-md-8 row ">
				<div class="col-12 col-md-3" style="min-width:100px;">
					Using this codeset:
				</div>
				<div ngbDropdown class="col-12 col-md-8" style="min-width:150px;">
					<button class="btn btn-primary col-12  p-2 m-2" id="dropdownBasic2" ngbDropdownToggle>
						{{selectedCodeSetDropDown2.name}}
					</button>
					<div ngbDropdownMenu aria-labelledby="dropdownBasic2">
						<button (click)="setCodeSetDropDown2(item);"
								*ngFor="let item of CodeSets;" class="dropdown-item">
							{{item.name}}
						</button>
					</div>
				</div>
			</div>
			<div class="form-group col-md-8 row">
				<div class="col-12 col-md-3" style="min-width:100px;">
					To this person:
				</div>
				<div ngbDropdown class="col-12 col-md-8" style="min-width:150px;">
					<button class="btn btn-primary col-12  p-2 m-2" id="dropdownBasic3" ngbDropdownToggle>
						{{selectedMemberDropDown3.contactName}}
					</button>
					<div ngbDropdownMenu aria-labelledby="dropdownBasic3">
						<button (click)="SetMemberDropDown3(member); "
								*ngFor="let member of reviewInfoService.Contacts" class="dropdown-item">
							{{member.contactName}}
						</button>
					</div>
				</div>
			</div>
			<div class="col-md-8 row">
				<div class="col-md-4"></div>
				<div class="form-group col-md-8 row">
					<button class="btn btn-outline-success col-12 col-md-3 p-3 m-3" [disabled]="CanNewWorkAllocationCreate()" (click)="WorkAssignment()" style="min-width:150px;">Assign</button>
					<button class="btn btn-outline-dark col-12 col-md-3 p-3 m-3" (click)="CloseAssignSection()" style="min-width:150px;">Cancel</button>
				</div>
			</div>
		</div>
	</div>
</div>
<div id="NewCodeSection" *ngIf="NewCodeSection" class="col-12 col-md-12 p-0 mb-1">
		<div class="card container-fluid mt-1 bg-light border border-primary rounded m-1 p-1 form-group">
			<div class="font-weight-bold col-md-4">Code Name</div>
			<input pattern="^(?!\s*$).+" [(ngModel)]="codeName"
				   #codeNameModel="ngModel"
				   id="codeNameModel" name="codeNameModel"
				   required minlength="3"
				   type="text"
				   placeholder="codeName"
				   class="col-md-4 form-control" />

			<div *ngIf="codeNameModel.invalid && (codeNameModel.dirty || codeNameModel.touched)"
				 class="alert alert-danger">

				<div *ngIf="codeNameModel.errors.pattern">
					Cannot be empty
				</div>

				<div *ngIf="codeNameModel.errors.required">
					code name  is required.
				</div>
				<div *ngIf="codeNameModel.errors.minlength">
					code name must be at least 3 characters long.
				</div>
			</div>

			<div class="font-weight-bold col-md-4">Description</div>
			<textarea pattern="^(?!\s*$).+" [(ngModel)]="description"
					  #descriptionModel="ngModel"
					  id="descriptionModel" name="descriptionModel"
					  required minlength="3"
					  placeholder="Description" class="col-md-4 form-control"></textarea>
			<div *ngIf="descriptionModel.invalid && (descriptionModel.dirty || descriptionModel.touched)"
				 class="alert alert-danger">

				<div *ngIf="descriptionModel.errors.pattern">
					Cannot be empty
				</div>

				<div *ngIf="descriptionModel.errors.required">
					description is required.
				</div>
				<div *ngIf="descriptionModel.errors.minlength">
					description must be at least 3 characters long.
				</div>

			</div>
			<div class="font-weight-bold col-md-4">Code Type</div>
			<div ngbDropdown class="col-12 col-md-4 pr-1 pl-1">
				<button class="btn btn-primary col-12 p-2 m-2" id="dropdownBasicNewCode"
						ngbDropdownToggle>
					{{selectedCodeSetDropDown}}
				</button>
				<div ngbDropdownMenu aria-labelledby="dropdownBasicNewCode">
					<button (click)="setCodeSetDropDown(item)"
							*ngFor="let item of CodeSets;" class="dropdown-item">
						{{item}}
					</button>
				</div>
			</div>
			<div class="font-weight-bold col-md-4">Index Number</div>
			<input type="text" name="indexNumber" class="col-md-4  form-control" />
			<div class="row col-md-4">
				<div class="col-md-6">
					<button type="submit" class="btn btn-info p-2 m-2" style="min-width:162px;max-width:162px;">Save</button>
				</div>
				<div class="col-md-6">
					<button type="submit" class="btn btn-danger p-2 m-2" style="min-width:162px;max-width:162px;">Cancel</button>
				</div>
			</div>
		</div>
	</div>
<div class="col-12 p-0 mb-1 bg-light" style="min-height:300px;">
	<div class="col-12 row p-0 m-0">
		<div class="card  col-sm-12 col-md-3 px-1">
			<h5 class="m-1 p-1 font-weight-bold">Reviewers</h5>
			<div style="max-height:340px;overflow:auto;">
				<table class='card-body table table-striped bg-light' *ngIf="_workAllocationListService.ContactWorkAllocations">
					<thead>
						<tr class="small">
							<th>ID</th>
							<th>Name</th>
						</tr>
					</thead>
					<tbody>
						<tr class="small" *ngFor="let member of reviewInfoService.Contacts; let i = index">
							<td>{{ member.contactId }}</td>
							<td>{{ member.contactName }}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="card col-sm-12 col-md-9 px-1 ">
			<h5 class="m-1 p-1 font-weight-bold"> Coding Assignments</h5>
			<div style="max-height:340px;overflow:auto;">
				<table class='small table table-striped bg-light' *ngIf="_workAllocationListService.AllWorkAllocationsForReview">
					<thead>
						<tr>
							<th>ID</th>
							<th>Contact</th>
							<th>Study Group</th>
							<th>Codes to apply</th>
							<th>Allocated</th>
							<th>Started</th>
							<th>Remaining</th>
							<th>Delete</th>
						</tr>
					</thead>
					<tbody>
						<tr class="" *ngFor="let wa of _workAllocationListService.AllWorkAllocationsForReview; let i = index">
							<td>{{ wa.contactId }}</td>
							<td>{{ wa.contactName }}</td>
							<td>{{ wa.attributeName }}</td>
							<td>{{wa.setName}}</td>
							<td class="p-0" id="waAll-{{wa.workAllocationId}}" [ngClass]="{'UsedWorkAllocation' : 'waAll-'+ wa.workAllocationId == this.clickedIndex}" (click)="LoadGivenList(wa.workAllocationId,'GetItemWorkAllocationList')"><div class="btn btn-link mt-1">{{ wa.totalAllocation}}</div></td>
							<td class="p-0 " id="waStarted-{{wa.workAllocationId}}" [ngClass]="{'UsedWorkAllocation' : 'waAll-'+ wa.workAllocationId == this.clickedIndex}" (click)="LoadGivenList(wa.workAllocationId,'GetItemWorkAllocationListStarted')"><div class="btn btn-link mt-1">{{ wa.totalStarted}}</div></td>
							<td class="p-0" id="waRemaining-{{wa.workAllocationId}}" [ngClass]="{'UsedWorkAllocation' : 'waAll-'+ wa.workAllocationId == this.clickedIndex}" (click)="LoadGivenList(wa.workAllocationId,'GetItemWorkAllocationListRemaining')"><div class="btn btn-link mt-1">{{ wa.totalRemaining}}</div></td>
							<td class="p-0"><button class="btn btn-danger p-1 m-1" (click)="removeWarning(wa.workAllocationId)">Delete</button></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
