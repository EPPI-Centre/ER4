<div class="col-12 p-1 m-2 rounded border container border-info">
    <div class="row my-1 mx-0 alert alert-success h4">
        Distribute work, step {{CurrentStep}}. {{CurrentStepName}}.
    </div>
    <div class="col-12 rounded border border-info alert-info m-1 p-1 ">
        This wizard allows to distribute work for an entire coding exercise, all in one go. You will be asked a series of questions pertaining:<br />
        <ol class="pl-4 mb-0">
            <li [ngClass]="{'font-weight-bold' : CurrentStep==1}">
                <div class="row m-0">
                    What items need to be coded 
                    <div *ngIf="workAllocationFromWizardCommand.numberOfItemsToAssign > 0" class="small border border-success rounded bg-light ml-1 px-1">
                        N of items: {{ItemsInTheSelectedPot}}
                        | {{workAllocationFromWizardCommand.filterType}}
                        <span *ngIf="workAllocationFromWizardCommand.filterType == 'No code / coding tool filter'">
                            ({{IncludedExcludedText}}, {{workAllocationFromWizardCommand.percentageOfWholePot}}%)
                        </span>
                        <span *ngIf="workAllocationFromWizardCommand.filterType == 'All without any codes from this coding tool' || workAllocationFromWizardCommand.filterType == 'All with any codes from this coding tool'">
                            ({{selectedCodeSetDropDown.name}}, {{IncludedExcludedText}}, {{workAllocationFromWizardCommand.percentageOfWholePot}}%)
                        </span>
                        <span *ngIf="workAllocationFromWizardCommand.filterType == 'All with this code' || workAllocationFromWizardCommand.filterType == 'All without this code'">
                            ({{DropdownWithWithoutSelectedCode?.name}}, {{IncludedExcludedText}}, {{workAllocationFromWizardCommand.percentageOfWholePot}}%)
                        </span>
                    </div>
                </div>
            </li>
            <li [ngClass]="{'font-weight-bold' : CurrentStep==2}">The coding work itself</li>
            <li [ngClass]="{'font-weight-bold' : CurrentStep==3}">How to distribute the work</li>
        </ol>
    </div>
    <div *ngIf="CurrentStep==1" class="">
        <div class="row my-1 mx-0">
            <div class="col-3">
                1. Select items by this criterion:
            </div>
            <div class="col-5">
                <select #AllocateOptionsDropDown class="form-control" name="AllocateOptions"
                        style="min-width: 200px; max-width:720px;" (change)="SetRelevantDropDownValues($event.target.value)">
                    <!--(click)="isCollapsedAllocateOptions = false; isCollapsedCodingTool = false"-->
                    <option *ngFor="let item of AllocateOptions" [value]="item.key"
                            [selected]="item.key == workAllocationFromWizardCommand.filterType">
                        {{item.value}}
                    </option>
                </select>
                <div *ngIf="workAllocationFromWizardCommand.filterType != ''">
                    <div *ngIf="workAllocationFromWizardCommand.filterType == 'No code / coding tool filter'">You will use all {{IncludedExcludedText}} items.</div>
                    <div *ngIf="workAllocationFromWizardCommand.filterType == 'All without any codes from this coding tool' || workAllocationFromWizardCommand.filterType == 'All with any codes from this coding tool'">
                        <div class="col-12" style="">
                            Select Coding Tool:
                        </div>
                        <div ngbDropdown class="col-12 col-sm-10" style="min-width:200px;">
                            <button class="btn btn-outline-secondary dropdown-toggle col-12"
                                    style="min-width: 200px; max-width:720px;"
                                    (click)="isCollapsedAllocateOptions = false; isCollapsedCodingTool = false; isCollapsedCodeStudies = false;"
                                    id="dropdownBasicCodingTool" ngbDropdownToggle>
                                {{selectedCodeSetDropDown.name}}
                            </button>
                            <div ngbDropdownMenu aria-labelledby="dropdownBasicCodingTool">
                                <button (click)="setCodeSetDropDown(item)"
                                        *ngFor="let item of CodeSets;" class="dropdown-item">
                                    {{item.name}}
                                </button>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="workAllocationFromWizardCommand.filterType == 'All with this code' || workAllocationFromWizardCommand.filterType == 'All without this code'">
                        <div class="col-12">
                            Select code:
                        </div>
                        <div ngbDropdown class="col-12 col-sm-10">
                            <button ngbDropdownAnchor class="btn btn-outline-secondary dropdown-toggle col-12"
                                    id="dropdownTreeRandomAllocate"
                                    style="min-width: 200px; max-width:720px;"
                                    (click)="isCollapsedAllocateOptions = !isCollapsedAllocateOptions;"
                                    [attr.aria-expanded]="!isCollapsedAllocateOptions" aria-controls="collapseCodeTreeWithWithout">
                                {{DropdownWithWithoutSelectedCode?.name}}
                            </button>
                            <div ngbDropdownMenu class="dropdown-menu" id="collapseCodeTreeWithWithout" [ngbCollapse]="!isCollapsedAllocateOptions">
                                <codesetSelector [IsMultiSelect]="false"
                                                 [WhatIsSelectable]="'SetAttribute'" [MaxHeight]="500" #WithOrWithoutCode
                                                 (selectedNodeInTree)="CloseCodeDropDownCodeWithWithout()"></codesetSelector>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-4 rounded border border-info alert-info small">
                The list of options allows to identify the items you need to work on in several ways.
                If you none of the options are suitable, you may need to create a new code for this purpose (in and Administration coding tool),
                generate your desired list of items and then assign the whole list to this new code.
            </div>
        </div>
        <div class="row my-1 mx-0 border-top" [ngClass]="{'DisabledStep' : !SelectionCriteriaIsValid}">
            <div class="col-3">
                2. Included or Excluded?
            </div>
            <div class="col-5">
                <div class="col-12 row justify-content-center justify-content-md-start m-1">
                    <input class="mt-1 mr-1 ml-sm-4" type="radio" [disabled]="!SelectionCriteriaIsValid" [value]="true" (click)="ClearPot()" [(ngModel)]="workAllocationFromWizardCommand.included">
                    <div class="mr-2">Included</div>
                    <input class="mt-1 mr-1" type="radio" value="false" [value]="false" [disabled]="!SelectionCriteriaIsValid" (click)="ClearPot()" [(ngModel)]="workAllocationFromWizardCommand.included">
                    <div class="mr-2">Excluded</div>
                </div>
            </div>
            <div class="col-4 rounded border border-info alert-info small">
                Given the criterion above, limit your selection to items with the "I" (Include) or "E" (Exclude) flag?
            </div>
        </div>
        <div class="row my-1 mx-0 border-top" [ngClass]="{'DisabledStep' : !SelectionCriteriaIsValid}">
            <div class="col-3">
                3. Percentage of references?
            </div>
            <div class="col-5 row m-0">
                <div>
                    <kendo-numerictextbox [(ngModel)]="workAllocationFromWizardCommand.percentageOfWholePot"
                                          [disabled]="!SelectionCriteriaIsValid"
                                          [min]="1" [format]="'n0'"
                                          [max]="100"
                                          [step]="1"
                                          [autoCorrect]="true"
                                          (valueChange)="ClearPot()"
                                          class="border border-dark rounded mt-1"
                                          style="width: 100px;">
                    </kendo-numerictextbox>
                    <button class=" pt-1 m-1 border border-dark rounded  btn btn-sm btn-outline-primary" style="min-width:70px" [disabled]="!SelectionCriteriaIsValid" (click)="GetPreview(1)">
                        Preview
                    </button>
                </div>
                <div class="align-self-center ml-2" *ngIf="workAllocationFromWizardCommand.numberOfItemsToAssign >= 0">Corresponding to <b>{{ItemsInTheSelectedPot}} items</b></div>
            </div>
            <div class="col-4 rounded border border-info alert-info small">
                Given the criteria so far, will you use all the items thus identified or only a percentage? Click on "preview" to get the exact number of items you'll be using.
            </div>
        </div>
        <div class="row justify-content-center">
            <button class=" pt-1 m-1 border border-dark rounded  btn btn-success" style="min-width:100px" [disabled]="!CanGoToStep2()" (click)="NextStep()">
                Next
            </button>
            <button class=" pt-1 m-1 border border-dark rounded btn btn-outline-dark " style="min-width:100px">
                Cancel
            </button>
        </div>
    </div>
    <div *ngIf="CurrentStep==2" class="col-12 p-1 m-2 rounded border container border-info">
        <div class="row justify-content-center">
            <button (click)="PreviousStep()" class=" pt-1 m-1 border border-dark rounded btn btn-outline-dark " style="min-width:100px">
                Previous
            </button>
            <button class=" pt-1 m-1 border border-dark rounded  btn btn-success" style="min-width:100px" (disabled)="!CanGoToNextStep()" (click)="NextStep()">
                Next
            </button>
            <button class=" pt-1 m-1 border border-dark rounded btn btn-outline-dark " style="min-width:100px">
                Cancel
            </button>
        </div>
    </div>
    <div *ngIf="CurrentStep==3" class="col-12 p-1 m-2 rounded border container border-info">
        <button (click)="PreviousStep()" class=" pt-1 m-1 border border-dark rounded btn btn-outline-dark " style="min-width:100px">
            Previous
        </button>
        <!--<button class=" pt-1 m-1 border border-dark rounded  btn btn-success" style="min-width:100px" (disabled)="!CanGoToNextStep()" (click)="NextStep()">
            Next
        </button>-->
        <button class=" pt-1 m-1 border border-dark rounded btn btn-outline-dark " style="min-width:100px">
            Cancel
        </button>
    </div>
</div>
<!--<div  class="card container-fluid mt-1 bg-light  m-1 p-1 form-group">
    <h2>I'm the new wizard, fool!</h2>
    <form class="row" #NewCodeFromCollaborate="ngForm" (ngSubmit)="onSubmit()">
        <div class="col-12">
            <div class="form-group">
                <label for="Codeset_TypeCollaborate">Code Type*</label>
                <select #CodeTypeSelectCollaborate class="form-control" name="NewCode_TypeCollaborate"
                        [disabled]="!CurrentCodeCanHaveChildren">
                    <option *ngFor="let type of _reviewSetsService.AllowedChildTypesOfSelectedNode" [value]="type.key" [selected]="type.key == _reviewSetsService.AllowedChildTypesOfSelectedNode[0].key">
                        {{type.value}}
                    </option>
                </select>
            </div>
        </div>
        <div class="form-group col-12">
            <label for="source_NameCollaborate">Code Name*</label>
            <input type="text" class="form-control" id="AttName" [disabled]="!CurrentCodeCanHaveChildren"
                   [(ngModel)]="NewCode.attribute_name" name="attribute_name"
                   #name="ngModel">
            <span [hidden]="IsNewCodeNameValid()"
                  class="alert alert-danger small p-1">
                Name is required
            </span>
        </div>
        <div class="form-group col-12 mt-2">
            <label for="newSetDescriptionCollaborate">Description (optional)</label>
            <textarea class="form-control" id="newSetDescription" [disabled]="!CurrentCodeCanHaveChildren"
                      [(ngModel)]="NewCode.attribute_set_desc" name="newAttDescription" rows="3"></textarea>
        </div>
        <div class="col-12">
            <button type="submit" (click)="CreateNewCode()"
                    class="btn btn-success ml-2 mr-2"
                    [disabled]="!NewCodeFromCollaborate.dirty || !IsNewCodeNameValid() || !CurrentCodeCanHaveChildren">
                Create
            </button>
            <button class="btn btn-outline-secondary ml-2 mr-2" type="button"
                    (click)="CancelActivity()">
                Cancel
            </button>
        </div>
    </form>
</div>-->


