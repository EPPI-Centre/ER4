
<div *ngIf="!IsSmall" class="card container-fluid mt-1 bg-light  m-1 p-1 form-group">
    <div  class="container card card-body bg-light">
        <div *ngIf="ShowPanel == 'DeleteCode'" class="alert alert-danger">
            <div>Are you sure you want to delete '{{UpdatingCode.attribute_name}}' and all its children?</div>
            <div>This will affect codes assigned to <strong>{{appliedCodes}}</strong> items. All this coding will be deleted!</div>
            <div>Also all codes assigned to '{{UpdatingCode.attribute_name}}' children (if any) <strong>will be lost</strong>.</div>
            <div>
                <button class="btn btn-outline-secondary ml-1" (click)="HideDeleteCodeset()" style="width:200px;">No</button>
                <button class="btn btn-danger ml-1" (click)="DoDeleteCode()"
                        [disabled]="!CanWrite() "
                        style="width:80px;">
                    Yes
                </button>
            </div>
        </div>
        <div *ngIf="ShowPanel == 'MoveCode'" class="">
            <div class="p-1">Please select the <b>Destination Code</b> from the area below.</div>
            <div class="border border-primary rounded p-1 m-1">
                <codesetTree4Move #codesetTree4Move [MaxHeight]="300" [SelectedCodeset]="ReviewSetOfUpdatingCode" [SelectedNode]="UpdatingCode"></codesetTree4Move>
            </div>
            <div class="p-1 mb-2">
                Moving: <b class="rounded border border-dark background bg-white p-1">{{UpdatingCode.name}}</b> into 
                <b class="rounded border border-dark p-1 " 
                   [ngClass]="{'alert-danger' : !codesetTree4Move.CanMoveBranchHere, 'alert-success' : codesetTree4Move.CanMoveBranchHere}">{{codesetTree4Move.DestinationBranchName}}</b>
            </div>
            <button class="btn btn-outline-secondary ml-1" (click)="HideDeleteCodeset()" style="width:200px;">Cancel</button>
            <button class="btn btn-outline-primary ml-1" (click)="DoMoveBranch(codesetTree4Move.DestinationBranch)" [disabled]="!codesetTree4Move.CanMoveBranchHere">Move!</button>
        </div>
        <form *ngIf="ShowPanel !== 'MoveCode'" class="row" #EditCodeFrom="ngForm" (ngSubmit)="onSubmit()">
            <div class="col-12">
                <div class="form-group">
                    <label for="Codeset_Type">Code Type*</label>
                    <select #EditCodeTypeSelect class="col-md-6 form-control"
                            (change)="AttributeTypeChanged($event.target.value)" name="Code_Type"
                            [(ngModel)]="UpdatingCode.attribute_type_id">
                        <option *ngFor="let type of AllowedChildTypes" [value]="type.key" [selected]="UpdatingCode && type.key == UpdatingCode.attribute_type_id">
                            {{type.value}}
                        </option>
                    </select>
                </div>
            </div>
            <div class="form-group col-12">
                <label for="source_Name">Code Name*</label>
                <input type="text" class="form-control" id="AttName"
                       [(ngModel)]="UpdatingCode.attribute_name" name="attribute_name"
                       #name="ngModel">
                <span [hidden]="IsNewCodeNameValid()"
                      class="alert alert-danger small p-1">
                    Name is required
                </span>
            </div>
            <div class="form-group col-12">
                <label for="newSetDescription">Description (optional)</label>
                <textarea class="form-control" id="newSetDescription"
                          [(ngModel)]="UpdatingCode.attribute_set_desc" name="newAttDescription" rows="3"></textarea>
            </div>
            <div class="col-12">
                <button type="submit" (click)="UpdateCode()" class="btn btn-success ml-2 mr-2" [disabled]="!EditCodeFrom.dirty || !IsNewCodeNameValid() || !CanWrite() ">
                    Update
                </button>
                <button class="btn btn-outline-primary ml-1" type="button"
                        (click)="ShowMoveCodeClicked()" [disabled]="!CanWrite()">
                    Move...
                </button>
                <button class="btn btn-outline-danger ml-1" (click)="ShowDeleteCodesetClicked()" type="button"
                        [disabled]="!CanWrite()">
                    Delete Code...
                </button>
                <button class="btn btn-outline-secondary ml-2" type="button"
                        (click)="CancelActivity(EditCodeFrom.dirty)" style="width:200px;">
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>


<div *ngIf="IsSmall" class="row small mx-0">

        <div *ngIf="ShowDeleteCode" class="alert alert-danger">
            <div>Are you sure you want to delete '{{UpdatingCode.attribute_name}}' and all its children?</div>
            <div>This will affect codes assigned to <strong>{{appliedCodes}}</strong> items. All this coding will be deleted!</div>
            <div>Also all codes assigned to '{{UpdatingCode.attribute_name}}' children (if any) <strong>will be lost</strong>.</div>
            <div>
                <button class="btn btn-sm btn-outline-secondary ml-1" (click)="HideDeleteCodeset()" style="width:80px;">No</button>
                <button class="btn btn-sm btn-danger ml-1" (click)="DoDeleteCode()"
                        [disabled]="!CanWrite() "
                        style="width:40px;">
                    Yes
                </button>
            </div>
        </div>
        <form class="row" #EditCodeFrom="ngForm" (ngSubmit)="onSubmit()">
            <div class="col-12">
                <div class="form-group">
                    <div for="Codeset_Type">Code Type*</div>
                    <select #EditCodeTypeSelect class="p-1"
                            (change)="AttributeTypeChanged($event.target.value)" name="Code_Type"
                            [(ngModel)]="UpdatingCode.attribute_type_id">
                        <option *ngFor="let type of AllowedChildTypes" [value]="type.key" [selected]="UpdatingCode && type.key == UpdatingCode.attribute_type_id">
                            {{type.value}}
                        </option>
                    </select>
                </div>
            </div>
            <div class="form-group col-12">
                <div for="source_Name">Code Name*</div>
                <input type="text" class="form-control" id="AttName"
                       [(ngModel)]="UpdatingCode.attribute_name" name="attribute_name"
                       #name="ngModel">
                <span [hidden]="IsNewCodeNameValid()"
                      class="alert alert-danger small p-1">
                    Name is required
                </span>
            </div>
            <div class="form-group col-12">
                <div for="newSetDescription">Description (optional)</div>
                <textarea class="form-control" id="newSetDescription"
                          [(ngModel)]="UpdatingCode.attribute_set_desc" name="newAttDescription" rows="3"></textarea>
            </div>
            <div class="col-12 mb-1">
                <button type="submit" (click)="UpdateCode()" class="btn btn-sm btn-success ml-2 mr-2" [disabled]="!EditCodeFrom.dirty || !IsNewCodeNameValid() || !CanWrite() ">
                    Update
                </button>
                <button class="btn btn-sm btn-outline-secondary ml-1" type="button"
                        (click)="CancelActivity(EditCodeFrom.dirty)" style="width:60px;">
                    Cancel
                </button>
                <button class="btn btn-sm btn-outline-danger ml-3" (click)="ShowDeleteCodesetClicked()" type="button"
                        [disabled]="!CanWrite() || !IsNewCodeNameValid()">
                    Delete Code...
                </button>
            </div>
        </form>
</div>
