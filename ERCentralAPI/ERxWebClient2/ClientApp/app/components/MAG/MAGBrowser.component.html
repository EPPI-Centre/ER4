<HeaderComponent #headerComponent Context="MAGBrowser"></HeaderComponent>
<button class="page-link rounded pt-1 pb-1 mb-1 float-right"
        style="position:absolute; right: 0; z-index:2000;" (click)="Back()">
    Close/back
</button>
<MAGHeaderBar></MAGHeaderBar>
<div class="p-2 m-2 card alert-primary  border-dark" >
    <h1 class="font-weight-light">Microsoft Academic Graph Browser</h1>

</div>

<div *ngIf="IsServiceBusy" class="k-loading-image" style="position: fixed; top: 2%;"></div>

<div *ngIf="_magAdvancedService.currentMagPaper.paperId > 0"
     class="alert-dark border border-dark p-2 m-2 ">
    <h4><b>{{_magAdvancedService.currentMagPaper.shortRecord}}</b></h4>
    <b>Paper Id:</b> <h4>{{_magAdvancedService.currentMagPaper.paperId}}</h4>
    <div *ngIf="!this._magAdvancedService.currentMagPaper.isSelected">
        <button  class="btn alert-success fa fa-plus" (click)="AddRemoveCurrentPaperToSelectedList()"></button>
    </div>
    <div  *ngIf="this._magAdvancedService.currentMagPaper.isSelected">
        <button class="btn alert-danger fa fa-minus" (click)="AddRemoveCurrentPaperToSelectedList()"></button>
    </div>
    <div class="btn btn-link">
        <a href="https://academic.microsoft.com/paper/{{_magAdvancedService.currentMagPaper.paperId}}/reference" target="_blank">
            View on the internet
        </a>
    </div>
    <button class="btn btn-link" (click)=toggleDisplayDivIf()>{{isShowDivIf == true ? 'Hide Abstract' : 'Show Abstract'}}</button>
    <div *ngIf="isShowDivIf">
        <b>Abstract:</b> <p>{{_magAdvancedService.currentMagPaper.abstract}}</p>
        <b>Pdf Links:</b>
        <div *ngFor="let item of GetPDFLinks()">
            <a href="{{item}}" target="_blank">
                {{item}}
            </a>
        </div>
    </div>
</div>
<div class="row border border-dark card-footer p-2 m-2">
    <div class="col-6"></div>
    <div *ngIf="_magBrowserService.MAGList.papers.length != 0 " class="col-3 pull-right">Total number of selected papers: {{ShowSelectedPapers}}</div>
    <div class="col-3 pull-right">Total number of papers in this list: {{_magBrowserService.MAGOriginalList.totalItemCount}}</div>
    <div>
        <button class="btn alert-primary fa fa-plus-square" (click)="ShowOriginal()">Show Original Search For Papers</button>
    </div>
    <div *ngIf="ShowOriginalPapers">
        <div>
            <h5>Original Papers identified from auto-identification MAG run </h5>

        </div>

        <div>
            <table class="card-footer col-12 small table table-border table-striped sortable">
                <thead>
                    <tr></tr>
                </thead>
                <tbody>
                    <tr style="cursor: pointer;" *ngFor="let item of _magBrowserService.MAGOriginalList.papers">
                        <td (click)="GetMagPaperRef(item.paperId)">
                            {{item.shortRecord}}
                        </td>
                        <td>
                            <button (click)="InOutReview(item)" 
                                    [class]="item.isSelected == true ? 'btn fa fa-minus' : 'btn fa fa-plus'">
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div *ngIf="_magBrowserService.MAGOriginalList && _magBrowserService.MAGOriginalList.papers && _magBrowserService.MAGOriginalList.IsBusy">Loading items...</div>
            <div *ngIf="_magBrowserService && _magBrowserService.MAGOriginalList.papers.length == 0"
                 class="p-2 font-weight-bold text-center text-info mt-1">No items to display</div>
            <div class="col-12 row">
                <MAGOrigpaginatorComp class="row ml-1 pt-1 mr-1 pr-1 border-top porder-info"></MAGOrigpaginatorComp>
            </div>
        </div>
    </div>
</div>
<div class="col-lg-12 row card-footer border border-dark p-2 m-2 " style="min-width:450px;max-height:950px; overflow:auto;">

    <div [title]="'TOPICS'" class="col-lg-6 col-md-12" style="min-height:500px;min-width:450px; overflow:auto;">
        <b>Current parent topic:</b> {{_magBrowserService.ParentTopic}}
        <h5>Parent Topics</h5>

        <div class="card-footer  col-12 small table table-border  table-striped alert-primary">

            <div *ngFor="let item of _magBrowserService.WPParentTopics">
                <div (click)="GetParentAndChildRelatedPapers(item)" class="col-2 btn border border-0"
                        [ngStyle]="{ 'font-size.em': item.fontSize,'background-color': 'light-blue', 'color': 'black'}">
                    {{item.displayName }}
                </div>

            </div>
        </div>
        <h5>Children Topics</h5>
        <div class="card-footer col-12 small table table-border table-striped">

            <div class="row">
                <div *ngFor="let item of _magBrowserService.WPChildTopics">
                    <div (click)="GetParentAndChildRelatedPapers(item)" class="col-2 btn border border-0"
                            [ngStyle]="{ 'font-size.em': item.fontSize,'background-color': 'light-blue', 'color': 'black'}">
                        {{item.displayName}}
                    </div>
                </div>
            </div>
        </div>
        <div class="row col-12" *ngIf="_magAdvancedService.currentMagPaper.paperId == 0">
            <div class="col-sm-12 col-lg-4 " >
                <div class="col-1 m-0 p-0"></div>
                <div class="col-sm-12 col-lg-6  m-0 p-0 "><b>After this date:</b></div>
                <div class="example-wrapper col-sm-12 col-lg-6" >
                    <kendo-datepicker [(value)]="kendoAfterDateValue"></kendo-datepicker>
                </div>
            </div>
            <div class="col-sm-12 col-lg-4 " >
                <div class="col-1 m-0 p-0"></div>
                <div class="col-sm-12 col-lg-6 m-0 p-0 "><b>Before this date:</b></div>
                <div class="example-wrapper col-sm-12 col-lg-6" >
                    <kendo-datepicker [(value)]="kendoBeforeDateValue"></kendo-datepicker>
                </div>
            </div>
            <button (click)="RefreshPapersBetweenDates()" class="btn btn-lg btn-outline-dark h-25 fa fa-refresh"></button>
        </div>
    </div>

    <kendo-tabstrip #tabSelectedPapers (tabSelect)="onTabSelect($event)" class="col-lg-6 col-md-12" [keepTabContent]="true">
        <kendo-tabstrip-tab [selected]="true" [title]="'References'">
            <ng-template kendoTabContent>

                <div [title]="'References'" style="min-height:500px;min-width:450px; overflow:auto;">

                    <div>
                        <h5>Papers identified from auto-identification MAG run</h5>
                            
                    </div>

                    <div>
                        <table class="card-footer col-12 small table table-border table-striped">
                            <thead>
                                <tr></tr>
                            </thead>
                            <tbody>
                                <tr style="cursor: pointer;" *ngFor="let item of _magBrowserService.MAGList.papers">
                                    <td (click)="GetMagPaperRef(item.paperId)">
                                        {{item.shortRecord}}
                                    </td>
                                    <td>
                                        <button (click)="InOutReview(item)" 
                                                [class]="item.isSelected == true ? 'btn fa fa-minus' : 'btn fa fa-plus'">
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div *ngIf="_magBrowserService.MAGList && _magBrowserService.MAGList.papers && _magBrowserService.MAGList.IsBusy">Loading items...</div>
                        <div *ngIf="_magBrowserService && _magBrowserService.MAGList.papers.length == 0"
                                class="p-2 font-weight-bold text-center text-info mt-1">No items to display</div>
                        <div class="col-12 row">
                            <MAGpaginatorComp class="row ml-1 pt-1 mr-1 pr-1 border-top porder-info"></MAGpaginatorComp>
                            <div *ngIf="_magBrowserService.currentFieldOfStudy.fieldOfStudyId > 0">
                                <select (change)="UpdatePageSize($event.target.value)">
                                    <option [value]="20">20</option>
                                    <option [value]="50">50</option>
                                    <option [value]="100">100</option>
                                </select>
                            </div>
                        </div>

                    </div>
                </div>

            </ng-template>
        </kendo-tabstrip-tab>
        <kendo-tabstrip-tab [title]="'Cited By'" [disabled]="HideCitatedBy()">
            <ng-template kendoTabContent>
                <div [title]="'Citated By'" style="min-height:500px;min-width:450px; overflow:auto;">
                    <div>
                        <table class="card-footer  col-12 small table table-border  table-striped ">
                            <thead>
                                <tr></tr>
                            </thead>
                            <tbody>
                                <tr style="cursor: pointer;" *ngFor="let item of _magBrowserService.MagCitationsByPaperList.papers">
                                    <td (click)="GetMagPaperRef(item.paperId)">{{item.fullRecord}}</td>
                                    <td>
                                        <button (click)="InOutReview(item)" class="btn btn-outline-success">
                                            {{item.isSelected}}
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </ng-template>
        </kendo-tabstrip-tab>
        
        <kendo-tabstrip-tab #tabSelectedPapers (tabSelect)="onTabSelect($event)" [title]="'Selected Papers'" [disabled]="HideSelectedPapers()">
                <ng-template kendoTabContent>
                    <div [title]="'Selected Papers'" style="min-height:500px;min-width:450px; overflow:auto;">
                        <div>
                            <table class="card-footer col-12 small table table-border table-striped ">
                                <thead>
                                    <tr></tr>
                                </thead>
                                <tbody>
                                    <tr style="cursor: pointer;" *ngFor="let item of _magBrowserService.selectedPapers">
                                        <td (click)="GetMagPaperRef(item.paperId)">{{item.fullRecord}}</td>
                                        <td>
                                            <button (click)="InOutReview(item)" class="btn btn-outline-success">
                                                {{item.isSelected == true ? 'UnSelect' : 'Select'}}
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <!--<MAGpaginatorComp class="row ml-1 pt-1 mr-1 pr-1 border-top porder-info"></MAGpaginatorComp>-->
                        </div>
                    </div>
                </ng-template>
            </kendo-tabstrip-tab>
            
        </kendo-tabstrip>

</div>
<statusbar></statusbar>
