<UserControl x:Class="EppiReviewer4.dialogMagBrowser"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ToolkitRef="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
    xmlns:radDock="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.Docking"
    xmlns:telerikGridView="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.GridView"
    xmlns:grid="clr-namespace:Telerik.Windows.Controls.GridView;assembly=Telerik.Windows.Controls.GridView"
    xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
    xmlns:cslaXAML="clr-namespace:Csla.Xaml;assembly=Csla.Xaml"
    xmlns:dpager="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.Data"
    xmlns:local="clr-namespace:EppiReviewer4;assembly=EppiReviewer4"
    mc:Ignorable="d"
    xmlns:helper="clr-namespace:EppiReviewer4.Helpers"
    d:DesignHeight="800" d:DesignWidth="1000">

    <UserControl.Resources>

        <cslaXAML:CslaDataProvider x:Key="PaperListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagPaperList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagPaperList" 
                           DataChanged="CslaDataProvider_DataChanged">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="PaperListAssociatedTopicsData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagFieldOfStudyList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagFieldOfStudyList" 
                           DataChanged="CslaDataProvider_DataChanged_1">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="ParentTopicsData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagFieldOfStudyList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagFieldOfStudyList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="TopicPaperListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagPaperList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagPaperList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="CitationPaperListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagPaperList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagPaperList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="CitedByListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagPaperList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagPaperList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="RecommendationsListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagPaperList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagPaperList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="HistoryListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="True"
                           ObjectType="BusinessLibrary.BusinessClasses.MagBrowseHistoryList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagBrowseHistoryList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="SearchTopicsData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagFieldOfStudyList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagFieldOfStudyList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="RelatedPapersRunListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagRelatedPapersRunList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagRelatedPapersRunList" 
                           DataChanged="CslaDataProvider_DataChanged_2">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagReviewListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagReviewList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagReviewList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="ClassifierContactModelListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.ClassifierContactModelList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetClassifierContactModelList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagSimulationListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagSimulationList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagSimulationList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagSimulationResultListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagSimulationResultList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagSimulationResultList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagLogListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagLogList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagLogList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagSearchListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagSearchList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagSearchList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagAutoUpdateListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagAutoUpdateList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagAutoUpdateList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagAutoUpdateRunListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagAutoUpdateRunList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagAutoUpdateRunList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <cslaXAML:CslaDataProvider x:Key="MagCurrentInfoListData"
                           ManageObjectLifetime="True"
                           IsInitialLoadEnabled="False"
                           ObjectType="BusinessLibrary.BusinessClasses.MagCurrentInfoList, BusinessLibrary, Version=..., Culture=neutral, PublicKeyToken=null"
                           FactoryMethod="GetMagCurrentInfoList" 
                           DataChanged="CslaDataProvider_HandleDataChangeError">
        </cslaXAML:CslaDataProvider>
        <helper:ReverseBooleanConverter x:Key="ReverseBoolean" />

        <!--<helper:SelectedNotSelectedConverter x:Key="SelectedNotSelectedText" />
            Not using this now - simple binding is sufficient. Leaving in case I do need it. Refers to code in ButtonConverters.cs
        -->

        <Style TargetType="grid:GridViewCell" x:Name="cellSelectedNotSelected">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <HyperlinkButton x:Name="HLSelectUnSelect" Margin="5,2,5,2" VerticalAlignment="Center" HorizontalAlignment="Center" Click="HLSelectUnSelect_Click"
                                    Content="{Binding CanBeSelected, Mode=TwoWay}" IsTabStop="False"></HyperlinkButton>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="grid:GridViewCell" x:Name="cellStyleDeleteSearch">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Button x:Name="cmdDeleteSearch" Click="cmdDeleteSearch_Click">
                            <Image Width="22" Height="22" Source="Icons/trash.png" ToolTipService.ToolTip="Delete search" />
                        </Button>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </UserControl.Resources>

    <Grid  x:Name="LayoutRoot" Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="40"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>

        <Grid x:Name="HeaderGrid" Grid.Row="0" Background="Beige">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="600*"></ColumnDefinition>
                <ColumnDefinition Width="400*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <TextBlock x:Name="tbAcademicTitle" TextWrapping="Wrap"  Text="Microsoft Academic Graph browser" FontSize="12" FontStyle="Italic" Margin="5,10,5,5"></TextBlock>
                <TextBlock x:Name="tbMatchedRecordsTitle" TextWrapping="Wrap"  Text="" FontSize="10" FontStyle="Italic" Margin="5,13,5,5"></TextBlock>
                <TextBlock x:Name="tbImportingRecords" Grid.Column="0" Text="Importing records..." FontSize="12" FontStyle="Italic" Margin="20,10,5,5" Visibility="Collapsed"></TextBlock>
                <cslaXAML:BusyAnimation x:Name="BusyImportingRecords"  Width="50" Height="40" HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </StackPanel>
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <HyperlinkButton x:Name="HLShowSelected" Content="Show selected (0)" Margin="5,5,5,5" HorizontalAlignment="Right" Click="HLShowSelected_Click" IsTabStop="False"></HyperlinkButton>
                <HyperlinkButton x:Name="HLClearSelected" Content="Clear selected" Margin="5,5,5,5" HorizontalAlignment="Right" Click="HLClearSelected_Click" IsTabStop="False"></HyperlinkButton>
                <HyperlinkButton x:Name="HLImportSelected" Content="Import selected" Margin="5,5,5,5" HorizontalAlignment="Right" Click="HLImportSelected_Click" IsTabStop="False"></HyperlinkButton>
                <HyperlinkButton x:Name="HLBack" Grid.Column="3" Content="Back" Margin="20,5,3,5" HorizontalAlignment="Right" Click="HLBack_Click" IsTabStop="False"></HyperlinkButton>
                <HyperlinkButton x:Name="HLForward" Grid.Column="3" Content="Forward" Margin="3,5,20,5" HorizontalAlignment="Right" Click="HLForward_Click" IsTabStop="False"></HyperlinkButton>
            </StackPanel>
            
        </Grid>
        <!-- end header grid -->

        <radDock:RadDocking Grid.Row="1">
            <radDock:RadDocking.DocumentHost>
                <radDock:RadSplitContainer >
                    <radDock:RadPaneGroup x:Name="Panes" SelectionChanged="Panes_SelectionChanged">
                        <radDock:RadDocumentPane Header="Bring review up to date" Title="Bring review up to date" CanFloat="False" CanUserClose="False" Tag="BringUpToDate">
                            <Grid x:Name="RelatedPapersGrid" Grid.Row="1" Background="Beige">

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="250"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="0" x:Name="RowCreateNewRelatedPapersRun"></RowDefinition>
                                    <RowDefinition Height="0" x:Name="RowCreateNewPmidSearch"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80*"></ColumnDefinition>
                                    <ColumnDefinition Width="20*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Vertical">
                                    <TextBlock FontSize="14" Margin="5,5,5,5">Bring your review up to date by finding related papers</TextBlock>
                                    <TextBlock TextWrapping="Wrap"  Margin="5,10,5,5" Text="On this page you can bring your review up to date by finding papers related to those already in your review automatically.&#10;
&#10;This special type of search uses Microsoft Academic graph, exploiting the connections in the graph between the papers already in your review and other 'nearby' papers. For these features to work it's essential that you have your existing included items matched to their equivalent Microsoft Academic records. If you haven't done this yet, go to the 'Match records' tab and match your records in. Once this is done, you can use the functions on this page in two ways.&#10;
&#10;First, for review updates. Set the 'Items dated from' date to the date that your searches were last run. Select your preferred graph search method ('full graph search' is the most comprehensive).&#10;
&#10;Second, to conduct 'snowball' searches around records you have already included. To accomplish this, you should set the 'items dated from' parameter to the earliest eligible date for papers in your review.&#10;
&#10;If you want to try out the performance of the graph search in your review, go to the 'Test graph search' tab above."></TextBlock>
                                </StackPanel>

                                <Image Grid.Row="0" Grid.Column="1" Source="./Icons/MAG.jpg" Margin="5,5,5,5" HorizontalAlignment="Right" VerticalAlignment="Top"></Image>

                                <StackPanel Grid.Row="1" Orientation="Horizontal">
                                    <HyperlinkButton x:Name="LBAddNewRagRelatedPapersRun" Margin="5,5,5,5" Content="Add new search for related papers" Click="LBAddNewRagRelatedPapersRun_Click" Tag="ClickToOpen" IsTabStop="False"></HyperlinkButton>
                                    <HyperlinkButton x:Name="LBOpenPmidSearch" Margin="5,5,5,5" Content="Add search by PubMed ID" Tag="ClickToOpen" IsTabStop="False" Click="LBOpenPmidSearch_Click"></HyperlinkButton>
                                </StackPanel>
                                
                                <Grid Grid.Row="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowSelectCodeRelatedPapersRun"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Description" Grid.Row="0" Grid.Column="0" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Right"></TextBlock>
                                    <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                                        <TextBox x:Name="tbRelatedPapersRunDescription" Margin="5,5,5,5" Width="320" VerticalAlignment="Center"></TextBox>
                                        <TextBlock Text="Search mode" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <ComboBox x:Name="ComboRelatedPapersMode" Margin="5,5,5,5" VerticalAlignment="Center" Width="320" SelectionChanged="ComboRelatedPapersMode_SelectionChanged">
                                            <ComboBoxItem Content="Papers 'recommended' by known items ('Recommended by')" Tag="Recommended by"></ComboBoxItem>
                                            <ComboBoxItem Content="Papers that 'recommend' known items ('That recommend')" Tag="That recommend"></ComboBoxItem>
                                            <ComboBoxItem Content="Bi-directional recommendation relationships ('Recommendations')" Tag="Recommendations" IsSelected="True"></ComboBoxItem>
                                            <ComboBoxItem Content="Papers in the bibliography of known items ('Bibliography')" Tag="Bibliography"></ComboBoxItem>
                                            <ComboBoxItem Content="Papers that cite known items ('Cited by')" Tag="Cited by"></ComboBoxItem>
                                            <ComboBoxItem Content="Bi-directional citation relationships" Tag="BiCitation"></ComboBoxItem>
                                            <ComboBoxItem Content="Bi-directional recommendation AND citation relationships ('Bi-Citation AND Recommendations)'" Tag="Bi-Citation AND Recommendations"></ComboBoxItem>
                                        </ComboBox>
                                    </StackPanel>

                                    <TextBlock Text="Search based on" Grid.Row="1" Grid.Column="0" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Right"></TextBlock>
                                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Left">
                                        <RadioButton x:Name="RadioButtonRelatedPapersRunAllIncluded" Content="All included items in review" IsChecked="True" Margin="5,5,5,5" GroupName="RadioButtonsRelatedPapersRun" VerticalAlignment="Center" Tag="AllIncluded" Checked="RadioButton_Checked"></RadioButton>
                                        <RadioButton x:Name="RadioButtonRelatedPapersRunWithCode" Content="Items with specified code" Margin="5,5,5,5" GroupName="RadioButtonsRelatedPapersRun" Tag="WithThisCode" VerticalAlignment="Center" Checked="RadioButton_Checked_1"></RadioButton>
                                        <!--"<RadioButton x:Name="RadioButtonRelatedPapersRunChildrenOfCode" Content="Multiple searches with each child of this code" Margin="5,5,5,5" GroupName="RadioButtonsRelatedPapersRun" Tag="WithChildrenOfThisCode" IsEnabled="False" VerticalAlignment="Center" Checked="RadioButton_Checked_1"></RadioButton>-->
                                        <local:codesSelectControl x:Name="codesSelectControlRelatedPapersRun" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="5,5,5,5" Width="150" Height="30" Visibility="Collapsed"></local:codesSelectControl>
                                    </StackPanel>

                                    <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                        <RadioButton x:Name="RadioButtonRelatedPapersRunNoDateRestriction" Content="No date restriction" IsChecked="True" Margin="5,5,5,5" GroupName="RadioButtonsRelatedPapersDate" VerticalAlignment="Center" Checked="RadioButton_Checked_2"></RadioButton>
                                        <RadioButton x:Name="RadioButtonRelatedPapersRunDateFilter" Content="Items dated from" Margin="5,5,5,5" GroupName="RadioButtonsRelatedPapersDate" VerticalAlignment="Center" Checked="RadioButton_Checked_3"></RadioButton>
                                        <telerik:RadDatePicker x:Name="DatePickerRelatedPapersRun" Visibility="Collapsed" VerticalAlignment="Center"></telerik:RadDatePicker>
                                    </StackPanel>
                                    <HyperlinkButton x:Name="LBAddRelatedPapersRun" Content="Add new search for related papers" Grid.Row="4" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Center" Click="LBAddRelatedPapersRun_Click" IsTabStop="False"></HyperlinkButton>
                                </Grid>

                                <Grid Grid.Row="3">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="40"></RowDefinition>
                                        <RowDefinition Height="40"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Enter PubMed Ids" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                    <TextBox x:Name="tbRelatedRunPmids" Grid.Row="0" Grid.Column="1" Margin="5,5,50,5" VerticalAlignment="Center"></TextBox>
                                    <HyperlinkButton x:Name="lbRelatedRunSearchPmids" Grid.Row="1" Grid.ColumnSpan="2" Content="Search for these (comma-separated) PubMed Ids" Margin="5,5,5,5" IsTabStop="False" Click="lbRelatedRunSearchPmids_Click"></HyperlinkButton>
                                </Grid>

                                <telerikGridView:RadGridView x:Name="RelatedPapersRunGrid" Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="False" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding Source={StaticResource RelatedPapersRunListData}, Path=Data, Mode=TwoWay}"
                                    IsEnabled="{Binding Source={StaticResource RelatedPapersRunListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed" CanUserSelect="False" Margin="10,20,10,20"
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                    <telerikGridView:RadGridView.Columns>
                                        <telerikGridView:GridViewDataColumn Header="Description" DataMemberBinding="{Binding UserDescription}" Width="70*"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Mode" Width="120" DataMemberBinding="{Binding Mode}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Date from" DataMemberBinding="{Binding DateFrom}" Width="85" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Date run" DataMemberBinding="{Binding DateRun}" Width="85" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="All included" Width="100" DataMemberBinding="{Binding AllIncluded}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="With this code" Width="80*" DataMemberBinding="{Binding AttributeName}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Status" Width="80" DataMemberBinding="{Binding Status}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="User status" Width="80" DataMemberBinding="{Binding UserStatus}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Delete" Click="HyperlinkButton_Click_2"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Import" Click="HyperlinkButton_Click_4"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50*" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="{Binding NPapers}" Click="HyperlinkButton_Click_3"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>

                                    </telerikGridView:RadGridView.Columns>

                                </telerikGridView:RadGridView>

                            </Grid>


                        </radDock:RadDocumentPane>
                        <!-- end review update -->
                        
                        <radDock:RadDocumentPane Header="Keep review up to date" Title="Keep review up to date" CanFloat="False" CanUserClose="False" Tag="AutoUpdate">
                            <Grid Background="Beige">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0" x:Name="RowAutoUpdateImport"></RowDefinition>
                                    <RowDefinition Height="200"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="0" x:Name="RowCreateNewAutoUpdate"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="100*"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="100*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="20*"></ColumnDefinition>
                                    <ColumnDefinition Width="80*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                
                                <Image Grid.Row="1" Grid.Column="0" Source="./Icons/MAG.jpg" Margin="5,5,10,5" HorizontalAlignment="Right" VerticalAlignment="Top"></Image>

                                <Grid x:Name="GridAutoUpdateImport" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Background="LightGray" Margin="5,5,5,5">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowAutoUpdateRunStudyClassifiers"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowAutoUpdateRunUserClassifiers"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowAutoUpdateTextFilterJournal"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowAutoUpdateTextFilterURL"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowAutoUpdateTextFilterDOI"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200*"></ColumnDefinition>
                                        <ColumnDefinition Width="200*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Text="Refine and import results" FontSize="14" Margin="5,5,5,5"></TextBlock>
                                    <telerik:RadCartesianChart x:Name="MagAutoUpdateChart" Grid.Row="1" Grid.RowSpan="6" Grid.Column="0" Margin="15,5,15,15"
                                   Background="White">
                                        <telerik:RadCartesianChart.HorizontalAxis>
                                            <telerik:CategoricalAxis Title="Range" />
                                        </telerik:RadCartesianChart.HorizontalAxis>
                                        <telerik:RadCartesianChart.VerticalAxis>
                                            <telerik:LinearAxis Title="Number of items"/>
                                        </telerik:RadCartesianChart.VerticalAxis>
                                        <telerik:BarSeries CategoryBinding="Range" ValueBinding="Count" IsHitTestVisible="True"
                                                           ItemsSource="{Binding Source={StaticResource MagAutoUpdateVisualiseData}, Path=Data}">
                                            <telerik:BarSeries.TrackBallTemplate>
                                                <DataTemplate>
                                                    <StackPanel>
                                                        <Rectangle Width="5"
                                                            Height="5"
                                                            Fill="Red"
                                                            RenderTransformOrigin="0.5,0.5">
                                                            <Rectangle.RenderTransform>
                                                                <RotateTransform Angle="45"/>
                                                            </Rectangle.RenderTransform>
                                                        </Rectangle>
                                                        <Border Background="Bisque">
                                                            <TextBlock Text="{Binding DisplayContent}"/>
                                                        </Border>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </telerik:BarSeries.TrackBallTemplate>
                                        </telerik:BarSeries>
                                        <telerik:RadCartesianChart.Behaviors>
                                            <telerik:ChartSelectionBehavior DataPointSelectionMode="Multiple" ></telerik:ChartSelectionBehavior>
                                            <telerik:ChartTrackBallBehavior ShowIntersectionPoints="True" ShowTrackInfo="False"/>
                                        </telerik:RadCartesianChart.Behaviors>
                                    </telerik:RadCartesianChart>

                                    <StackPanel Grid.Row="7" Grid.Column="0" Orientation="Horizontal">
                                        <TextBlock Text="Graph:" Margin="5,5,3,5"></TextBlock>
                                        <RadioButton x:Name="AutoUpdateGraphShowAutoUpdateModel" Content="Auto-update model" Margin="5,5,5,5" GroupName="AutoUpdateGraphShowGroup" IsChecked="True" Checked="AutoUpdateGraphShowAutoUpdateModel_Checked"></RadioButton>
                                        <RadioButton x:Name="AutoUpdateGraphShowStudyTypeModel" Content="Study type classifier" Margin="5,5,5,5" GroupName="AutoUpdateGraphShowGroup" Checked="AutoUpdateGraphShowAutoUpdateModel_Checked"></RadioButton>
                                        <RadioButton x:Name="AutoUpdateGraphShowUserModel" Content="User classifier" Margin="5,5,5,5" GroupName="AutoUpdateGraphShowGroup" Checked="AutoUpdateGraphShowAutoUpdateModel_Checked"></RadioButton>
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                                        <telerik:RadNumericUpDown x:Name="AutoUpdateAutoScoreThreshold" Minimum="0.2" Maximum="1" SmallChange="0.01" VerticalAlignment="Center" Value="0.2" Margin="5,5,5,5"></telerik:RadNumericUpDown>
                                        <TextBlock Text="Auto-update model score threshold" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                        <telerik:RadNumericUpDown x:Name="AutoUpdateStudyTypeScoreThreshold" Minimum="0.0" Maximum="1" SmallChange="0.01" VerticalAlignment="Center" Value="0.0" Margin="5,5,5,5"></telerik:RadNumericUpDown>
                                        <TextBlock Text="Study type classifier score threshold" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                        <telerik:RadNumericUpDown x:Name="AutoUpdateUserScoreThreshold" Minimum="0.0" Maximum="1" SmallChange="0.01" VerticalAlignment="Center" Value="0.0" Margin="5,5,5,5"></telerik:RadNumericUpDown>
                                        <TextBlock Text="User classifier score threshold" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock Text="Above thresholds filter out " Margin="5,5,0,5"></TextBlock>
                                        <TextBlock x:Name="AutoUpdateNRecordsFiltered" Text="0" Margin="0,5,0,5"></TextBlock>
                                        <TextBlock Text=" records" Margin="0,5,5,5"></TextBlock>
                                        <HyperlinkButton x:Name="AutoUpdateRefreshImportCount" Content="Refresh count" Margin="5,5,5,5" IsTabStop="False" Click="AutoUpdateRefreshImportCount_Click"></HyperlinkButton>
                                    </StackPanel>
                                    <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock Text="Import top:" Margin="5,5,2,5" VerticalAlignment="Center"></TextBlock>
                                        <telerik:RadNumericUpDown x:Name="AutoUpdateImportTopN" Minimum="0" SmallChange="1" IsInteger="True" VerticalAlignment="Center" Value="1" Margin="2,5,2,5" ValueChanged="AutoUpdateImportTopN_ValueChanged"></telerik:RadNumericUpDown>
                                        <TextBlock Text="in order of" Margin="2,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <ComboBox x:Name="comboAutoUpdateImportOptions" Margin="5,5,5,5" VerticalAlignment="Center">
                                            <ComboBoxItem Content="auto-update model" Tag="AutoUpdate" IsSelected="True"></ComboBoxItem>
                                            <ComboBoxItem Content="study type classifier" Tag="StudyTypeClassifier"></ComboBoxItem>
                                            <ComboBoxItem Content="user classifier" Tag="UserClassifier"></ComboBoxItem>
                                        </ComboBox>
                                    </StackPanel>

                                    <StackPanel Grid.Row="6" Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock x:Name="AutoUpdateNumberToImport" Text="Number to import: " Margin="5,5,5,5"></TextBlock>
                                        <HyperlinkButton x:Name="AutoUpdatePreviewPaperList" Content="List these items" Margin="5,5,5,5" Click="AutoUpdatePreviewPaperList_Click"></HyperlinkButton>
                                    </StackPanel>

                                    <StackPanel Grid.Row="8" Grid.Column="0" Orientation="Horizontal">
                                        <HyperlinkButton x:Name="AutoUpdateOpenClassifiers" Content="Select and run classifiers" Margin="5,5,5,5" IsTabStop="False" Click="AutoUpdateOpenClassifiers_Click" Tag="Open"></HyperlinkButton>
                                        <HyperlinkButton x:Name="AutoUpdateOpenTextFilters" Content="Text filters" Margin="5,5,5,5" IsTabStop="False" Click="AutoUpdateOpenTextFilters_Click" Tag="Open"></HyperlinkButton>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Row="8" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <HyperlinkButton x:Name="AutoUpdateCloseImport" Content="Close" Margin="5,5,5,5" IsTabStop="False" Click="AutoUpdateCloseImport_Click"></HyperlinkButton>
                                        <HyperlinkButton x:Name="AutoUpdateImport" Content="IMPORT" FontSize="12" Margin="5,5,5,5" IsTabStop="False" Click="AutoUpdateImport_Click"></HyperlinkButton>
                                    </StackPanel>

                                    <StackPanel Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
                                        <TextBlock Text="Study type classifier:" Margin="5,5,2,5" VerticalAlignment="Center"></TextBlock>
                                        <ComboBox x:Name="comboAutoUpdateStudyTypeClassifier" Margin="5,5,5,5" VerticalAlignment="Center">
                                            <ComboBoxItem Content="None" Tag="None" IsSelected="True"></ComboBoxItem>
                                            <ComboBoxItem Content="RCT" Tag="RCT"></ComboBoxItem>
                                            <ComboBoxItem Content="Cochrane RCT" Tag="Cochrane RCT"></ComboBoxItem>
                                            <ComboBoxItem Content="Economic evaluation" Tag="Economic evaluation"></ComboBoxItem>
                                            <ComboBoxItem Content="Systematic review" Tag="Systematic review"></ComboBoxItem>
                                        </ComboBox>
                                        <HyperlinkButton x:Name="hlAutoUpdateStudyClassifierRun" Margin="5,5,5,5" Content="Run this study type classifier" Click="hlAutoUpdateStudyClassifierRun_Click"></HyperlinkButton>
                                    </StackPanel>
                                    <StackPanel Grid.Row="10" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
                                        <TextBlock Margin="5,5,5,5" Text="User classifier:" VerticalAlignment="Center"></TextBlock>
                                        <ComboBox x:Name="comboAutoUpdateUserModels" 
                                            ItemsSource="{Binding Source={StaticResource ClassifierContactModelListData}, Path=Data}"
                                            Margin="5,5,5,5" VerticalAlignment="Center"></ComboBox>
                                        <HyperlinkButton x:Name="hlAutoUpdateUserClassifierRun" Margin="5,5,5,5" Content="Run this user-built classifier" Click="hlAutoUpdateUserClassifierRun_Click"></HyperlinkButton>
                                    </StackPanel>

                                    <StackPanel Grid.Row="11" Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock Text="Filter from journal field" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <TextBox x:Name="AutoUpdateTextFilterJournal" Margin="23,5,5,5" Width="200" VerticalAlignment="Center"></TextBox>
                                    </StackPanel>
                                    <StackPanel Grid.Row="12" Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock Text="Filter from URL field" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <TextBox x:Name="AutoUpdateTextFilterURL" Margin="40,5,5,5" Width="200" VerticalAlignment="Center"></TextBox>
                                    </StackPanel>
                                    <StackPanel Grid.Row="13" Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock Text="Filter from DOI field" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <TextBox x:Name="AutoUpdateTextFilterDOI" Margin="40,5,5,5" Width="200" VerticalAlignment="Center"></TextBox>
                                    </StackPanel>
                                </Grid>
                                <!-- END Sub grid for refine and import -->

                                <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Vertical">
                                    <TextBlock FontSize="14" Margin="5,5,5,5">Keep your review up to date with research as it is published</TextBlock>
                                    <TextBlock TextWrapping="Wrap"  Margin="5,10,5,5" Text="On this page you can keep your review up to date by automatically adding potentially relevant papers as soon as they are published.&#10;
&#10;This feature uses a copy of the Microsoft Academic dataset, that is updated every 1-2 weeks. It looks for all the new papers that have arrived since the last update, and then adds those to your review that are most similar to papers that you have already included. For this to work it's essential that you have your existing included items matched to their equivalent Microsoft Academic records. If you haven't done this yet, go to the 'Match records' tab and match your records in. As this feature ONLY looks at the new records that appear, you should ensure that your review is up to date first, by using the 'bring review up to date' feature.&#10;
&#10;You can use the 'filter' below to limit the items you want the auto-update to 'learn' from to a subset of items in your review. You can also obtain multiple updates per review if needed, for example, for specific subsets of records.&#10;"></TextBlock>
                                </StackPanel>

                                
                                <HyperlinkButton x:Name="LBAddNewAutoUpdate" Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Margin="5,5,5,5" Content="Add new review auto update" Click="LBAddNewAutoUpdate_Click"  Tag="ClickToOpen" IsTabStop="False"></HyperlinkButton>

                                <Grid Grid.Row="3" Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Description" Margin="5,5,5,5" HorizontalAlignment="Right" VerticalAlignment="Center"></TextBlock>
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="tbAutoUpdateDescription" Margin="5,5,5,5" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center"></TextBox>

                                    <TextBlock Text="Auto update based on" Grid.Row="1" Grid.Column="0" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Right"></TextBlock>
                                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Left">
                                        <RadioButton x:Name="RadioButtonAutoUpdateAllIncluded" Content="All included items in review" IsChecked="True" Margin="5,5,5,5" GroupName="RadioButtonsAutoUpdate" VerticalAlignment="Center" Tag="AllIncluded" Checked="RadioButtonAutoUpdateAllIncluded_Checked"></RadioButton>
                                        <RadioButton x:Name="RadioButtonAutoUpdateWithCode" Content="Items with specified code" Margin="5,5,5,5" GroupName="RadioButtonsAutoUpdate" Tag="WithThisCode" VerticalAlignment="Center" Checked="RadioButtonAutoUpdateWithCode_Checked"></RadioButton>
                                        <local:codesSelectControl x:Name="codesSelectControlAutoUpdate" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="5,5,5,5" Width="150" Height="30" Visibility="Collapsed"></local:codesSelectControl>
                                    </StackPanel>

                                    <HyperlinkButton x:Name="LBAddNewAutoUpdateDoAdd" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Margin="5,5,5,5" Content="Add new review auto update" Click="LBAddNewAutoUpdateDoAdd_Click"  IsTabStop="False"></HyperlinkButton>
                                </Grid>

                                <TextBlock Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" Text="Current auto updates set to run each MAG update" Margin="5,10,5,2"></TextBlock>
                                <telerikGridView:RadGridView Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2"
                                                             ItemsSource="{Binding Source={StaticResource MagAutoUpdateListData}, Path=Data, Mode=TwoWay}"
                                    IsEnabled="{Binding Source={StaticResource MagAutoUpdateListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed" CanUserSelect="False" ShowGroupPanel="False" AutoGenerateColumns="False">
                                    <telerikGridView:RadGridView.Columns>
                                        <telerikGridView:GridViewDataColumn Header="Description" DataMemberBinding="{Binding UserDescription}" Width="70*"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="All matched included items" Width="100" DataMemberBinding="{Binding AllIncluded}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Filtered to items with this code" Width="80*" DataMemberBinding="{Binding AttributeName}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>

                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Delete" Click="HyperlinkButton_Click_17"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                    </telerikGridView:RadGridView.Columns>
                                </telerikGridView:RadGridView>

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="Items identified by auto update runs" Margin="5,10,5,2"></TextBlock>
                                <telerikGridView:RadGridView Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="2"
                                    ItemsSource="{Binding Source={StaticResource MagAutoUpdateRunListData}, Path=Data, Mode=TwoWay}"
                                    IsEnabled="{Binding Source={StaticResource MagAutoUpdateRunListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed" CanUserSelect="False" ShowGroupPanel="False" AutoGenerateColumns="False">
                                    <telerikGridView:RadGridView.Columns>
                                        <telerikGridView:GridViewDataColumn Header="Description" DataMemberBinding="{Binding UserDescription}" Width="70*"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="All included" Width="100" DataMemberBinding="{Binding AllIncluded}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="With this code" Width="80*" DataMemberBinding="{Binding AttributeName}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Study type classifier" Width="80*" DataMemberBinding="{Binding StudyTypeClassifier}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="User Classifier" Width="80*" DataMemberBinding="{Binding UserClassifierDescription}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="MAG Version" Width="100*" DataMemberBinding="{Binding MagVersion}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Date Run" Width="80*" DataMemberBinding="{Binding DateRun}" IsReadOnly="True"></telerikGridView:GridViewDataColumn>
                                        
                                        <telerikGridView:GridViewDataColumn Width="130" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Refine and import" Click="HyperlinkButton_Click_18"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                    <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                        <telerikGridView:GridViewDataColumn.CellTemplate>
                                            <DataTemplate>
                                                <HyperlinkButton Content="{Binding NPapers}" Click="HyperlinkButton_Click_19"/>
                                            </DataTemplate>
                                        </telerikGridView:GridViewDataColumn.CellTemplate>
                                    </telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Delete" Click="HyperlinkButton_Click_20"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                    </telerikGridView:RadGridView.Columns>

                                </telerikGridView:RadGridView>
                            </Grid>
                            
                        </radDock:RadDocumentPane>
                        <!-- end auto review update -->

                        <radDock:RadDocumentPane Header="Match records" Title="Match records" CanFloat="False" CanUserClose="False" Tag="MatchItems">
                            <Grid Margin="5,5,5,5" Background="Beige">

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="50"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="40"></RowDefinition>
                                    <RowDefinition Height="35"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50*"></ColumnDefinition>
                                    <ColumnDefinition Width="50*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Text="Match user uploaded records into Microsoft Academic" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,5,5,5"></TextBlock>
                                <ToolkitRef:WrapPanel Grid.Row="1" Grid.Column="0" Margin="10,5,10,5" Orientation="Horizontal">
                                    <TextBlock TextWrapping="Wrap" FontSize="12" Margin="0,0,0,0" Text="The algorithm to find new and related studies to the ones you have already identified depends on correctly matching your existing records into the Microsoft Academic dataset.&#10;
&#10;While this process can be automated up to a point, some records cannot be matched with 100% confidence, and some cannot be matched at all.&#10;
&#10;In order to improve performance, it can be helpful to check the lower confidence automatic matches for accuracy (see links on the right of this page)."></TextBlock>
                                </ToolkitRef:WrapPanel>
                                
                                <Grid Grid.Row="1" Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="40"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="20*"></ColumnDefinition>
                                        <ColumnDefinition Width="40*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <HyperlinkButton x:Name="LBMatchAllIncluded" FontSize="11" Grid.Row="0" Grid.Column="0" Content="Run auto-matching algorithm" Margin="5,5,5,5" Click="LBMatchAllIncluded_Click" Tag="All" IsTabStop="False" HorizontalAlignment="Right" VerticalAlignment="Center"
                                     IsEnabled="{Binding Source={StaticResource MagCurrentInfoData}, Path=Data.MatchingAvailable, Mode=OneWay}"></HyperlinkButton>
                                    <HyperlinkButton x:Name="lbRefreshCounts" FontSize="11" Grid.Row="0" Grid.Column="1" Content="Refresh counts on this page" HorizontalAlignment="Left" VerticalAlignment="Center"
                                     Margin="5,5,5,5" Click="lbRefreshCounts_Click"  IsTabStop="False" Visibility="Collapsed"></HyperlinkButton>
                                    <HyperlinkButton x:Name="LbClearAllMatchesInReview" Grid.Row="1" Grid.Column="0" Content="Clear all matches in review" Margin="5,5,5,5" Click="LbClearAllMatchesInReview_Click"  Tag="ALL" IsTabStop="False" HorizontalAlignment="Right" VerticalAlignment="Center"
                                     IsEnabled="{Binding Source={StaticResource MagCurrentInfoData}, Path=Data.MatchingAvailable, Mode=OneWay}"></HyperlinkButton>

                                    <telerik:RadBusyIndicator x:Name="busyIndicatorMatches" Grid.Row="0" Grid.RowSpan="7" Grid.Column="1" Background="Transparent" BorderBrush="Transparent" />

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="All matched included records" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="4,3,4,3"></TextBlock>
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="All matched excluded records" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="4,3,4,3"></TextBlock>
                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="All matched records in review" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="4,3,4,3"></TextBlock>
                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Low confidence matches" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="4,3,4,3"></TextBlock>
                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="Unmatched records" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="4,3,4,3"></TextBlock>
                                    <TextBlock Grid.Row="7" Grid.Column="0" Text="Actions on items with this code" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="4,3,4,3"></TextBlock>

                                    <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                        <HyperlinkButton x:Name="LBListMatchesIncluded" Margin="4,3,4,3" HorizontalAlignment="Left" VerticalAlignment="Center" Click="LBListMatchesIncluded_Click" IsTabStop="False"></HyperlinkButton>
                                        <HyperlinkButton x:Name="lbItemListMatchesIncluded" Margin="1,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Content="(List)" Click="lbItemListMatchesIncluded_Click" IsTabStop="False"></HyperlinkButton>
                                        <TextBlock x:Name="tbPreviouslyMatchedRecords" Text="Previously matched records" Margin="4,3,4,3" HorizontalAlignment="Left" VerticalAlignment="Center"></TextBlock>
                                        <HyperlinkButton x:Name="LBListPreviouslyMatchedRecords" Margin="4,3,4,3" HorizontalAlignment="Left" VerticalAlignment="Center" IsTabStop="False" Content="List" IsEnabled="False" Click="LBListPreviouslyMatchedRecords_Click"></HyperlinkButton>
                                    </StackPanel>

                                    <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                        <HyperlinkButton x:Name="LBListMatchesExcluded" Margin="4,3,4,3" HorizontalAlignment="Left" VerticalAlignment="Center" Click="LBListMatchesExcluded_Click" IsTabStop="False"></HyperlinkButton>
                                        <HyperlinkButton x:Name="lbItemListMatchesExcluded" Margin="1,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Content="(List)" Click="lbItemListMatchesExcluded_Click"  IsTabStop="False"></HyperlinkButton>
                                    </StackPanel>

                                    <HyperlinkButton x:Name="LBListAllInReview" Grid.Row="4" Grid.Column="1" Margin="0,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Click="LBListAllInReview_Click" IsTabStop="False"></HyperlinkButton>

                                    <StackPanel Orientation="Horizontal" Grid.Row="5" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Center">
                                        <TextBlock Margin="4,3,4,3" Text="Included: "></TextBlock>
                                        <HyperlinkButton x:Name="LBManualCheckIncluded" Margin="0,5,0,0" Click="LBManualCheckIncluded_Click" IsTabStop="False"></HyperlinkButton>
                                        <TextBlock Margin="4,3,4,3" Text=" Excluded: "></TextBlock>
                                        <HyperlinkButton x:Name="LBManualCheckExcluded" Margin="0,5,0,0" Click="LBManualCheckExcluded_Click" IsTabStop="False"></HyperlinkButton>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal" Grid.Row="6" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Center">
                                        <TextBlock Margin="4,3,4,3" Text="Included: "></TextBlock>
                                        <HyperlinkButton x:Name="LBMNotMatchedIncluded" Content="N" Margin="0,5,0,0" Click="LBMNotMatchedIncluded_Click" IsTabStop="False"></HyperlinkButton>
                                        <TextBlock Margin="0,5,0,0" Text=" Excluded: "></TextBlock>
                                        <HyperlinkButton x:Name="LBMNotMatchedExcluded" Content="N" Margin="0,5,0,0" Click="LBMNotMatchedExcluded_Click" IsTabStop="False"></HyperlinkButton>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal" Grid.Row="7" Grid.Column="1">
                                        <local:codesSelectControl x:Name="codesSelectControlMAGSelect" Margin="4,3,4,3" Width="100" Height="25" HorizontalAlignment="Left" VerticalAlignment="Center"></local:codesSelectControl>
                                        <HyperlinkButton x:Name="LBListAllRelatedItemsWithThisCode" Margin="4,3,4,3" Content="List" VerticalAlignment="Center" Click="LBListAllRelatedItemsWithThisCode_Click" IsTabStop="False"></HyperlinkButton>
                                        <HyperlinkButton x:Name="LBAutomatchItemsWithThisCode" Margin="4,3,4,3" Content="Auto-match" VerticalAlignment="Center" Tag="WithThisCode" Click="LBMatchAllIncluded_Click" IsTabStop="False"></HyperlinkButton>
                                        <HyperlinkButton x:Name="LbClearAllMatchesWithThisCode" Content="Clear matches" Margin="4,3,4,3" Click="LbClearAllMatchesInReview_Click"  Tag="WithThisCode" IsTabStop="False" HorizontalAlignment="Right" VerticalAlignment="Center"></HyperlinkButton>
                                    </StackPanel>

                                    </Grid>

                                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Text="Find records by topic or ID" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,5,5,5"></TextBlock>
                                <TextBox x:Name="tbFindTopics" Grid.Row="3" Margin="5,5,5,0" TextChanged="tbFindTopics_TextChanged"></TextBox>
                                <ScrollViewer Grid.Row="4" Margin="5,0,5,5" HorizontalScrollBarVisibility="Disabled"  VerticalScrollBarVisibility="Auto">
                                    <ToolkitRef:WrapPanel x:Name="WPFindTopics"  Orientation="Horizontal">
                                        <TextBlock Margin="5,5,5,5" Text="Search for topics in the box above."></TextBlock>
                                    </ToolkitRef:WrapPanel>
                                </ScrollViewer>
                                <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                     <HyperlinkButton x:Name="lbGoToPaperId" Margin="5,5,5,5" Content="Go to this Microsoft Academic Paper ID" VerticalAlignment="Center" Click="lbGoToPaperId_Click" IsTabStop="False"></HyperlinkButton>
                                     <TextBox x:Name="tbGoToPaperId" Margin="3,5,5,5" Width="120"></TextBox>
                                </StackPanel>
                               
                            </Grid>

                        </radDock:RadDocumentPane>
                        <!-- end match items review-->

                        <radDock:RadDocumentPane Header="Test graph search" Title="Test graph search" CanFloat="False" CanUserClose="False" Tag="Simulation">
                            <Grid x:Name="StatusGrid">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="3*"></RowDefinition>
                                    <RowDefinition Height="2*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <!-- LHS grid-->
                                <Grid x:Name="GridSimulationsIntro" Grid.Column="0" Grid.Row="0" Margin="5,10,10,10" Background="Beige">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="auto"></RowDefinition>
                                        <RowDefinition Height="auto"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="30"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" FontSize="14" Margin="5,5,5,5" HorizontalAlignment="Center" VerticalAlignment="Center">Test bringing review up to date</TextBlock>
                                    <TextBlock Grid.Row="2" Margin="5,5,5,5" TextWrapping="Wrap" Text="The mechanism for bringing a review 'up to date' uses a 'graph search' of Microsoft Academic. This search examines the publications your included studies are closely connected to - by citation relationship, and by automatically generated keywords and 'recommended' documents.&#10;
&#10;These tests need you to split your records into two sets: 'train' and 'test'. The training records will be used to start the search off, with the connections related to this set being use to find the records in the 'test' set. Obviously, we want the search to find as many records as possible. You can create the split between train and test records in three ways: by year of publication, precise date of publication, and by records with/ without a code. We then use machine learning that aims to identify the 'test' records from the (sometimes large) set of records retrieved by the graph search. Please see the documentation for further information.&#10;
&#10;N.B. This page tests the performance of the graph search to bring your review up to date, as this depends on the graph search finding the records in your review. The algorithm that aims to keep your review up to date operates differently, as it assesses every record published each week (so doesn't have the limitation of the graph search)."></TextBlock>
                                </Grid>

                                <!-- RHS grid-->
                                <Grid x:Name="GridCreateSimulations" Grid.Column="1" Grid.Row="0" Margin="5,10,10,10" Background="Beige">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" FontSize="14" Margin="5,5,5,5" HorizontalAlignment="Center" VerticalAlignment="Center">Create new test</TextBlock>

                                    <TextBlock Grid.Row="1" Text="Split records into train and test sets by:" Margin="5,5,5,1" VerticalAlignment="Bottom"></TextBlock>
                                    <StackPanel Grid.Row="2" Orientation="Horizontal" VerticalAlignment="Center">
                                        <RadioButton x:Name="rbSimulationYear" Content="Year" GroupName="rbSimulation" IsChecked="True" Click="rbSimulationYear_Click" Tag="ShowDatePicker" Margin="5,5,5,5" VerticalAlignment="Center"></RadioButton>
                                        <RadioButton x:Name="rbSimulationCreatedDate" Content="Created date" GroupName="rbSimulation" IsChecked="False" Click="rbSimulationYear_Click" Tag="ShowDatePicker" Margin="5,5,5,5" VerticalAlignment="Center"></RadioButton>
                                        <RadioButton x:Name="rbSimulationWithThisCode" Content="With this code" GroupName="rbSimulation" IsChecked="False" Click="rbSimulationYear_Click" Tag="ShowCodesControl" Margin="5,5,5,5" VerticalAlignment="Center"></RadioButton>
                                        <telerik:RadDatePicker x:Name="DatePickerSimulation" SelectedValue="01/01/2010" Margin="5,5,5,5" Width="100" HorizontalAlignment="Center" VerticalAlignment="Center"></telerik:RadDatePicker>
                                        <local:codesSelectControl x:Name="codesSelectControlSimulation" Margin="5,5,5,5" Width="100" Height="25" VerticalAlignment="Center" Visibility="Collapsed"></local:codesSelectControl>
                                        <TextBlock Margin="5,5,5,5" x:Name="tbEndDate" Text="End date" VerticalAlignment="Center"></TextBlock>
                                        <telerik:RadDatePicker x:Name="DatePickerSimulationEnd" SelectedValue="01/01/2025" Margin="5,5,5,5" Width="100" HorizontalAlignment="Center" VerticalAlignment="Center"></telerik:RadDatePicker>
                                    </StackPanel>
                                    
                                    <TextBlock Grid.Row="3" Text="You can restrict the test to using a subset of records:" Margin="5,5,5,1" VerticalAlignment="Bottom"></TextBlock>
                                    <StackPanel Grid.Row="4" Orientation="Horizontal">
                                        <CheckBox x:Name="cbSimulationFilterByThisCode" Content="Filter by this code" IsChecked="False" Unchecked="cbSimulationFilterByThisCode_Unchecked" Checked="cbSimulationFilterByThisCode_Checked" Margin="5,5,5,5" VerticalAlignment="Center"></CheckBox>
                                        <local:codesSelectControl x:Name="codesSelectControlSimulationFilter" Margin="5,5,5,5" Width="100" Height="25" VerticalAlignment="Center" Visibility="Collapsed"></local:codesSelectControl>
                                    </StackPanel>

                                    <StackPanel Grid.Row="5" Orientation="Horizontal">
                                        <TextBlock Margin="5,5,5,5" Text="Search method" VerticalAlignment="Center"></TextBlock>
                                        <ComboBox x:Name="comboSimulationSearchMethod" Margin="5,5,5,5" VerticalAlignment="Center">
                                            <ComboBoxItem Content="BiCitation" Tag="BiCitation"></ComboBoxItem>
                                            <ComboBoxItem Content="Recommendations" Tag="Recommendations" IsSelected="True"></ComboBoxItem>
                                            <ComboBoxItem Content="Bi-Citation AND Recommendations" Tag="Bi-Citation AND Recommendations"></ComboBoxItem>
                                            <ComboBoxItem Content="Extended network" Tag="Extended network"></ComboBoxItem>
                                        </ComboBox>
                                        <TextBlock Margin="5,5,5,5" Text="Network statistic" VerticalAlignment="Center" Visibility="Collapsed"></TextBlock>
                                        <ComboBox x:Name="comboSimulationNetworkStats" Margin="5,5,5,5" VerticalAlignment="Center" Visibility="Collapsed">
                                            <ComboBoxItem Content="None" Tag="None" IsSelected="True"></ComboBoxItem>
                                            <ComboBoxItem Content="degree" Tag="degree"></ComboBoxItem>
                                            <ComboBoxItem Content="closeness" Tag="closeness"></ComboBoxItem>
                                            <ComboBoxItem Content="eigenscore" Tag="eigenscore"></ComboBoxItem>
                                            <ComboBoxItem Content="pagerank" Tag="pagerank"></ComboBoxItem>
                                            <ComboBoxItem Content="hubscore" Tag="hubscore"></ComboBoxItem>
                                            <ComboBoxItem Content="authscore" Tag="authscore"></ComboBoxItem>
                                            <ComboBoxItem Content="alpha" Tag="alpha"></ComboBoxItem>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel Grid.Row="6" Orientation="Horizontal">
                                        <TextBlock Margin="5,5,5,5" Text="Study type classifier" VerticalAlignment="Center"></TextBlock>
                                        <ComboBox x:Name="comboSimulationStudyTypeClassifier" Margin="5,5,5,5" VerticalAlignment="Center">
                                            <ComboBoxItem Content="None" Tag="None" IsSelected="True"></ComboBoxItem>
                                            <ComboBoxItem Content="RCT" Tag="RCT"></ComboBoxItem>
                                            <ComboBoxItem Content="Cochrane RCT" Tag="Cochrane RCT"></ComboBoxItem>
                                            <ComboBoxItem Content="Economic evaluation" Tag="Economic evaluation"></ComboBoxItem>
                                            <ComboBoxItem Content="Systematic review" Tag="Systematic review"></ComboBoxItem>
                                        </ComboBox>
                                        <TextBlock Margin="5,5,5,5" Text="User defined classifier" VerticalAlignment="Center"></TextBlock>
                                        <ComboBox x:Name="comboSimulationUserModels" 
                              ItemsSource="{Binding Source={StaticResource ClassifierContactModelListData}, Path=Data}"
                              Margin="5,5,5,5" VerticalAlignment="Center"></ComboBox>
                                    </StackPanel>

                                    <StackPanel Grid.Row="7" Orientation="Horizontal">
                                        <TextBlock Margin="5,5,4,5" Text="Score threshold " VerticalAlignment="Center"></TextBlock>
                                        <telerik:RadNumericUpDown x:Name="SimulationEditScoreThreshold" Minimum="0" Maximum="1" SmallChange="0.01" VerticalAlignment="Center" Value="0.5" Margin="5,5,5,5"></telerik:RadNumericUpDown>
                                        <TextBlock Margin="30,5,4,5" Text="FoS threshold " VerticalAlignment="Center"></TextBlock>
                                        <telerik:RadNumericUpDown x:Name="SimulationEditFoSThreshold" Minimum="0" Maximum="1" SmallChange="0.01" VerticalAlignment="Center" Value="0.0" Margin="5,5,5,5"></telerik:RadNumericUpDown>
                                    </StackPanel>

                                    <HyperlinkButton x:Name="lbRunSimulation" Grid.Row="8" Content="Add new simulation using above settings" Margin="5,5,5,5" IsTabStop="False" Click="lbRunSimulation_Click" VerticalAlignment="Bottom"></HyperlinkButton>

                                </Grid>

                                <Grid x:Name="GridSimulationResults" Grid.Column="1" Grid.Row="0" Margin="5,10,10,10" Background="Beige" Visibility="Collapsed">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <cslaXAML:BusyAnimation x:Name="loadingChartAnimation"  Grid.Row="0" Width="50" Height="50" HorizontalAlignment="Center" VerticalAlignment="Center" IsRunning="{Binding Source={StaticResource MagSimulationResultListData}, Path=IsBusy}"/>
                                    <telerik:RadCartesianChart x:Name="ChartRoc" Grid.Row="0" Margin="10,10,10,10">
                                        <telerik:RadCartesianChart.Behaviors>
                                            <telerik:ChartTrackBallBehavior ShowIntersectionPoints="True"
                                             ShowTrackInfo="False"/>
                                        </telerik:RadCartesianChart.Behaviors>
                                        <telerik:RadCartesianChart.HorizontalAxis>
                                            <telerik:LinearAxis Title="Number of items screened" Minimum="0"
                                    LastLabelVisibility="Hidden"/>
                                        </telerik:RadCartesianChart.HorizontalAxis>
                                        <telerik:RadCartesianChart.VerticalAxis>
                                            <telerik:LinearAxis Title="Number of relevant items found"/>
                                        </telerik:RadCartesianChart.VerticalAxis>
                                        <telerik:RadCartesianChart.Series>
                                            <telerik:ScatterLineSeries XValueBinding="NumberScreened"
                                           YValueBinding="CumulativeIncludeCount" 
                                           ItemsSource="{Binding Source={StaticResource MagSimulationResultListData}, Path=Data}">
                                                <telerik:ScatterLineSeries.TrackBallTemplate>
                                                    <DataTemplate>
                                                        <StackPanel>
                                                            <Rectangle Width="5"
                                                            Height="5"
                                                            Fill="Red"
                                                            RenderTransformOrigin="0.5,0.5">
                                                                <Rectangle.RenderTransform>
                                                                    <RotateTransform Angle="45"/>
                                                                </Rectangle.RenderTransform>
                                                            </Rectangle>
                                                            <Border Background="Bisque">
                                                                <TextBlock Text="{Binding DisplayContent}"/>
                                                            </Border>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </telerik:ScatterLineSeries.TrackBallTemplate>
                                            </telerik:ScatterLineSeries>
                                        </telerik:RadCartesianChart.Series>
                                    </telerik:RadCartesianChart>

                                    <StackPanel Orientation="Horizontal" Grid.Row="1">
                                        <RadioButton x:Name="rbROCNetwork" Content="Network" GroupName="RadioButtonGroupRoc" IsChecked="True" Margin="5,5,5,5" VerticalAlignment="Center" Click="rbROCNetwork_Click"></RadioButton>
                                        <RadioButton x:Name="rbROCDistance" Content="Topic distance" GroupName="RadioButtonGroupRoc" Margin="5,5,5,5" VerticalAlignment="Center" Click="rbROCNetwork_Click"></RadioButton>
                                        <RadioButton x:Name="rbROCUserClassifier" Content="User classifier" GroupName="RadioButtonGroupRoc" Margin="5,5,5,5" VerticalAlignment="Center" Click="rbROCNetwork_Click"></RadioButton>
                                        <RadioButton x:Name="rbROCStudyClassifier" Content="Study classifier" GroupName="RadioButtonGroupRoc" Margin="5,5,5,5" VerticalAlignment="Center" Click="rbROCNetwork_Click"></RadioButton>
                                        <RadioButton x:Name="rbROCEnsemble" Content="Ensemble" GroupName="RadioButtonGroupRoc" Margin="5,5,5,5" VerticalAlignment="Center" Click="rbROCNetwork_Click"></RadioButton>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Grid.Row="2">
                                        <HyperlinkButton x:Name="hlCloseGraph" Content="Close graph viewer" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Left" Click="hlCloseGraph_Click"></HyperlinkButton>
                                        <HyperlinkButton x:Name="hlDownloadData" Content="Pull data to browser" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Left" Click="hlDownloadData_Click"></HyperlinkButton>
                                        <HyperlinkButton x:Name="hlDownloadDataFromBrowser" Content="Download data" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Left" Visibility="Collapsed" Click="hlDownloadDataFromBrowser_Click"></HyperlinkButton>
                                        <cslaXAML:BusyAnimation x:Name="BusyLoadingSimulationData" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>

                                <!--
            <TextBlock x:Name="TBNumInReview" Grid.Column="1" Grid.Row="1" Text="N" HorizontalAlignment="Left" Margin="5,5,5,5"></TextBlock>
            -->



                                <telerikGridView:RadGridView x:Name="SimulationsGrid" Grid.Row="1" Grid.ColumnSpan="2" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="False" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding Source={StaticResource MagSimulationListData}, Path=Data, Mode=TwoWay}"
                                    IsEnabled="{Binding Source={StaticResource MagSimulationListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed" CanUserSelect="False" Margin="10,10,10,10"
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                    <telerikGridView:RadGridView.Columns>
                                        <telerikGridView:GridViewDataColumn Header="Method" DataMemberBinding="{Binding SearchMethod}" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True" Header="Status">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="{Binding Status}" Click="HyperlinkButton_Click_12"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>

                                        <telerikGridView:GridViewDataColumn Header="Seed method" DataMemberBinding="{Binding SeedText}" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="(Filter)" DataMemberBinding="{Binding FilteredByAttribute}" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Thresholds" DataMemberBinding="{Binding Thresholds}" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Study classifier" DataMemberBinding="{Binding StudyTypeClassifier}" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="User classifier" DataMemberBinding="{Binding UserClassifierModel}" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="40" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="ROC" Click="HyperlinkButton_Click_9"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="Seeds" DataMemberBinding="{Binding NSeeds}" Width="60" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="TP" Width="45" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="{Binding TP}" Click="HyperlinkButton_Click_11"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="FP" DataMemberBinding="{Binding FP}" Width="45" IsFilterable="False"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Header="FN" Width="45" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="{Binding FN}" Click="HyperlinkButton_Click_10"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Delete" Click="HyperlinkButton_Click_8"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                    </telerikGridView:RadGridView.Columns>
                                </telerikGridView:RadGridView>

                            </Grid>
                            <!-- end statusgrid (really the advanced features grid now) -->

                        </radDock:RadDocumentPane>
                        <!-- end simulation studies-->

                        <radDock:RadDocumentPane x:Name="SearchBrowsePane" Header="Search and browse" Title="Search and browse" CanFloat="False" CanUserClose="False" Tag="SearchBrowse">

                            <Grid>

                                <Grid x:Name="SearchGrid" Grid.Row="1" Visibility="Visible" Background="Beige">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="40"></RowDefinition>
                                        <RowDefinition Height="40"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowMagSearchTopics"></RowDefinition>
                                        <RowDefinition Height="40"></RowDefinition>
                                        <RowDefinition Height="40"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowMagSearchFilterJournal"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowMagSearchFilterUrl"></RowDefinition>
                                        <RowDefinition Height="0" x:Name="RowMagSearchFilterDoi"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"></ColumnDefinition>
                                        <ColumnDefinition Width="300"></ColumnDefinition>
                                        <ColumnDefinition Width="100"></ColumnDefinition>
                                        <ColumnDefinition Width="40"></ColumnDefinition>
                                        <ColumnDefinition Width="200"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <!--
                                    <Rectangle Grid.Column="3" Grid.Row="0" Grid.RowSpan="5">
                                        <Rectangle.Fill>
                                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                <GradientStop Color="LightGoldenrodYellow"  Offset="0" />
                                                <GradientStop Color="LightGray"  Offset="0" />
                                            </LinearGradientBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                    -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,5,5,5" Text="Specify search" FontStyle="Italic"></TextBlock>
                                    <ComboBox x:Name="ComboMagSearchSelect" Grid.Row="1" Grid.Column="0" Margin="5,5,5,5" SelectionChanged="ComboMagSearchSelect_SelectionChanged">
                                        <ComboBoxItem Content="Word(s) in title" IsSelected="True"></ComboBoxItem>
                                        <ComboBoxItem Content="Word(s) in abstract"></ComboBoxItem>
                                        <ComboBoxItem Content="Author name(s)"></ComboBoxItem>
                                        <ComboBoxItem Content="Topic"></ComboBoxItem>
                                        <ComboBoxItem Content="MAG ID"></ComboBoxItem>
                                        <ComboBoxItem Content="Journal"></ComboBoxItem>
                                        <ComboBoxItem Content="Custom"></ComboBoxItem>
                                    </ComboBox>
                                    <TextBox x:Name="TextBoxMagSearch" Grid.Row="1" Grid.Column="1" Margin="5,5,5,5" TextChanged="TextBoxMagSearch_TextChanged"></TextBox>
                                    <cslaXAML:BusyAnimation x:Name="BusyRunningMagSearch"  Grid.Row="1" Grid.Column="2"/>

                                    <TextBlock x:Name="MagSearchCurrentTopic" Grid.Row="2" Grid.Column="0" Margin="5,5,5,5" Text="" FontStyle="Italic"></TextBlock>
                                    <ScrollViewer x:Name="ScrollViewerMagSearchTopic" Grid.Row="2" Grid.Column="1" Margin="5,0,5,5" HorizontalScrollBarVisibility="Disabled"  VerticalScrollBarVisibility="Auto">
                                        <ToolkitRef:WrapPanel x:Name="WPMagSearchFindTopics"  Orientation="Horizontal">
                                            <TextBlock Margin="5,5,5,5" Text="Search for topics in the box above."></TextBlock>
                                        </ToolkitRef:WrapPanel>
                                    </ScrollViewer>

                                    <ComboBox x:Name="ComboMagSearchDateLimit" Grid.Row="3" Grid.Column="0" Margin="5,5,5,5" SelectionChanged="ComboMagSearchDateLimit_SelectionChanged">
                                        <ComboBoxItem Content="No date limit" IsSelected="True"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication date exactly"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication date before"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication date after"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication dates between"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication year exactly"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication year before"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication year after"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication years between"></ComboBoxItem>
                                    </ComboBox>

                                    <StackPanel x:Name="StackPanelMagSearchDates" Grid.Row="3" Grid.Column="1" Visibility="Collapsed" Orientation="Horizontal">
                                        <TextBlock x:Name="MagSearchDateText1" Text="from" Margin="5,11,5,5" HorizontalAlignment="Center"></TextBlock>
                                        <telerik:RadDatePicker x:Name="MagSearchDate1" Margin="5,5,5,5" HorizontalAlignment="Center"></telerik:RadDatePicker>
                                        <TextBlock x:Name="MagSearchDateText2" Text="to" Margin="5,11,5,5" HorizontalAlignment="Center"></TextBlock>
                                        <telerik:RadDatePicker x:Name="MagSearchDate2" Margin="5,5,5,5" HorizontalAlignment="Center"></telerik:RadDatePicker>
                                    </StackPanel>

                                    <ComboBox x:Name="ComboMagSearchPubTypeLimit" Grid.Row="4" Grid.Column="0" Margin="5,5,5,5">
                                        <ComboBoxItem Content="All publication types" IsSelected="True"></ComboBoxItem>
                                        <ComboBoxItem Content="Unknown types"></ComboBoxItem>
                                        <ComboBoxItem Content="Journal article"></ComboBoxItem>
                                        <ComboBoxItem Content="Patent"></ComboBoxItem>
                                        <ComboBoxItem Content="Conference paper"></ComboBoxItem>
                                        <ComboBoxItem Content="Book chapter"></ComboBoxItem>
                                        <ComboBoxItem Content="Book"></ComboBoxItem>
                                        <ComboBoxItem Content="Book reference entry"></ComboBoxItem>
                                        <ComboBoxItem Content="Dataset"></ComboBoxItem>
                                        <ComboBoxItem Content="Repository"></ComboBoxItem>
                                    </ComboBox>

                                    <HyperlinkButton x:Name="HyperLinkMagSearchDoSearch" Grid.Row="5" Grid.Column="0" Content="Run search!" Margin="5,5,5,5" FontWeight="Bold" FontSize="14" VerticalAlignment="Center" Click="HyperLinkMagSearchDoSearch_Click" IsTabStop="False"></HyperlinkButton>

                                    <TextBlock Grid.Row="0" Grid.Column="4" Text="Combine / filter / delete selected searches"  Grid.ColumnSpan="2" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,5,5,5" FontStyle="Italic"></TextBlock>
                                    <ComboBox x:Name="ComboMagSearchDateLimitFilter" Grid.Row="1" Grid.Column="4" Margin="5,5,5,5" SelectionChanged="ComboMagSearchDateLimitFilter_SelectionChanged">
                                        <ComboBoxItem Content="No date limit" IsSelected="True"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication date exactly"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication date before"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication date after"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication dates between"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication year exactly"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication year before"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication year after"></ComboBoxItem>
                                        <ComboBoxItem Content="Publication years between"></ComboBoxItem>
                                    </ComboBox>

                                    <StackPanel x:Name="StackPanelMagSearchDatesFilter" Grid.Row="1" Grid.Column="5" Visibility="Collapsed" Orientation="Horizontal">
                                        <TextBlock x:Name="MagSearchDateText1Filter" Text="from" Margin="5,11,5,5" HorizontalAlignment="Center"></TextBlock>
                                        <telerik:RadDatePicker x:Name="MagSearchDate1Filter" Margin="5,5,5,5" HorizontalAlignment="Center"></telerik:RadDatePicker>
                                        <TextBlock x:Name="MagSearchDateText2Filter" Text="to" Margin="5,11,5,5" HorizontalAlignment="Center"></TextBlock>
                                        <telerik:RadDatePicker x:Name="MagSearchDate2Filter" Margin="5,5,5,5" HorizontalAlignment="Center"></telerik:RadDatePicker>
                                        <HyperlinkButton x:Name="hlMagSearchDateLimitFilter2" Content="Filter by date" Margin="5,5,5,5" VerticalAlignment="Center" IsTabStop="False" Click="hlMagSearchDateLimitFilter2_Click"></HyperlinkButton>
                                    </StackPanel>

                                    <TextBlock Text="Combine selected searches with" Grid.Row="3" Grid.Column="4" Margin="5,5,4,5" VerticalAlignment="Center" HorizontalAlignment="Left"></TextBlock>
                                    <StackPanel Grid.Row="3" Grid.Column="5" Orientation="Horizontal">
                                        <ComboBox x:Name="MagSearchComboCombine" Margin="5,5,5,5" SelectionChanged="MagSearchComboCombine_SelectionChanged">
                                            <ComboBoxItem Content="AND" IsSelected="False"></ComboBoxItem>
                                            <ComboBoxItem Content="OR" IsSelected="False"></ComboBoxItem>
                                        </ComboBox>
                                       
                                    </StackPanel>
                                    <HyperlinkButton x:Name="hlDeleteSelectedMagSearches" Grid.Row="4" Grid.Column="4" Content="Delete selected searches" Margin="5,5,5,5" VerticalAlignment="Center" IsTabStop="False" Click="hlDeleteSelectedMagSearches_Click"></HyperlinkButton>
                                    <CheckBox x:Name="cbMagSearchShowTextFilters" Grid.Row="5" Grid.Column="4" Grid.ColumnSpan="2" Content="Use text filters to remove content from specific sources on import" Margin="5,5,5,5" IsChecked="false" Unchecked="cbMagSearchShowTextFilters_Unchecked" Checked="cbMagSearchShowTextFilters_Checked"></CheckBox>
                                    <StackPanel Grid.Row="6" Grid.Column="4" Grid.ColumnSpan="2" Orientation="Horizontal">
                                        <TextBlock Text="Filter from journal field" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <TextBox x:Name="MagSearchTextFilterJournal" Margin="23,5,5,5" Width="200" VerticalAlignment="Center"></TextBox>
                                    </StackPanel>
                                    <StackPanel Grid.Row="7" Grid.Column="4" Grid.ColumnSpan="2" Orientation="Horizontal">
                                        <TextBlock Text="Filter from URL field" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <TextBox x:Name="MagSearchTextFilterURL" Margin="40,5,5,5" Width="200" VerticalAlignment="Center"></TextBox>
                                    </StackPanel>
                                    <StackPanel Grid.Row="8" Grid.Column="4" Grid.ColumnSpan="2" Orientation="Horizontal">
                                        <TextBlock Text="Filter from DOI field" Margin="5,5,5,5" VerticalAlignment="Center"></TextBlock>
                                        <TextBox x:Name="MagSearchTextFilterDOI" Margin="40,5,5,5" Width="200" VerticalAlignment="Center"></TextBox>
                                    </StackPanel>
                                    
                                    <telerikGridView:RadGridView x:Name="SearchDataGrid" Grid.Row="9" Grid.ColumnSpan="6" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding Source={StaticResource MagSearchListData}, Path=Data, Mode=TwoWay}"
                                    RowIndicatorVisibility="Collapsed" CanUserSortColumns="True" 
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                        <telerikGridView:RadGridView.Columns>
                                            <telerikGridView:GridViewSelectColumn UniqueName="columnSelectMagSearch" Width="Auto">
                                                <telerikGridView:GridViewSelectColumn.Header>
                                                    <CheckBox Tag="MagSearchGrid" Click="CheckBox_Click" />
                                                </telerikGridView:GridViewSelectColumn.Header>
                                            </telerikGridView:GridViewSelectColumn>
                                            <telerikGridView:GridViewDataColumn DataMemberBinding="{Binding SearchNo}" Header="" Width="30"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="Search" Width="*">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding SearchText}" TextWrapping="Wrap"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="MAG search string" Width="*">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding MagSearchText}" TextWrapping="Wrap"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn DataMemberBinding="{Binding MagFolder}" Width="80" Header="MAG version"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn DataMemberBinding="{Binding ContactName}" Width="100" Header="User"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn DataMemberBinding="{Binding SearchDate, StringFormat='{}{0:MM/dd/yyyy}'}" Width="60" Header="Date"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn DataMemberBinding="{Binding HitsNo}" Header="Hits" Width="70"></telerikGridView:GridViewDataColumn>

                                            <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="Rerun" Click="HyperlinkButton_Click_15"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="Import" Click="HyperlinkButton_Click_16" Tag="MagSearchResults" ToolTipService.ToolTip="Import all records from this search"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="120" SortingState="None" IsReadOnly="True">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="Import latest MAG" Click="HyperlinkButton_Click_16" Tag="MagSearchResultsLatestMAG" ToolTipService.ToolTip="Filter import to include only records in the latest deployment of MAG"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="50" SortingState="None" IsReadOnly="True">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="List" Click="HyperlinkButton_Click_14"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="30" SortingState="None" IsReadOnly="True" CellStyle="{StaticResource cellStyleDeleteSearch}"></telerikGridView:GridViewDataColumn>
                                        </telerikGridView:RadGridView.Columns>
                                        

                                    </telerikGridView:RadGridView>

                                </Grid>
                                <!-- end search grid -->

                                <Grid x:Name="PaperGrid" Grid.Row="1" Visibility="Collapsed">
                                    <Grid.RowDefinitions>
                                        <RowDefinition x:Name="PaperGridHeadingRow" Height="61"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition x:Name="PaperGridAbstractRow" Height="0"></RowDefinition>
                                        <RowDefinition Height="25"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="300"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <Grid x:Name="GridPaperInfoBackground" Grid.Row="0" Grid.ColumnSpan="2">
                                        <TextBox x:Name="RTBPaperInfo" Grid.Row="0" Grid.ColumnSpan="2" TextWrapping="Wrap" BorderThickness="0" FontSize="17" IsReadOnly="True" Text="Authors et al (2019) This is the really very much longer title of the paper, Journal name: volume(issue): pages" Margin="0,8,0,0" ></TextBox>
                                    </Grid>
                                    
                                    <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Orientation="Horizontal">
                                        <TextBlock x:Name="tbPaperAlreadyInReview" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Left"></TextBlock>
                                        <HyperlinkButton x:Name="hlAddPaperToSelectedList" Content="Add to selected list" FontStyle="Italic" Margin="5,5,5,5" VerticalAlignment="Center" HorizontalAlignment="Left" Click="hlAddPaperToSelectedList_Click" IsTabStop="False"></HyperlinkButton>
                                    </StackPanel>
                                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBlock Text="PaperId: " HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5,5,0,5"></TextBlock>
                                        <TextBox x:Name="tbPaperId" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,5,5,5" IsReadOnly="True"></TextBox>
                                    </StackPanel>

                                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Vertical">
                                        <TextBox x:Name="tbAbstract" Grid.Row="2" Grid.ColumnSpan="2" TextWrapping="Wrap" ScrollViewer.VerticalScrollBarVisibility="Auto" BorderThickness="0"></TextBox>
                                        <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto" BorderThickness="0">
                                            <ToolkitRef:WrapPanel x:Name="WPPaperURLs" Orientation="Horizontal">

                                            </ToolkitRef:WrapPanel>
                                        </ScrollViewer>
                                    </StackPanel>

                                    <HyperlinkButton x:Name="hlFindOnWeb" Grid.Row="3" Grid.Column="0" Content="View on the web" HorizontalAlignment="Left" Margin="5,5,5,5" TargetName="_blank" IsTabStop="False"></HyperlinkButton>
                                    <HyperlinkButton x:Name="HLExpandContract" Grid.Row="3" Grid.ColumnSpan="2" FontSize="13" HorizontalAlignment="Center" Content="&lt;&lt;&lt;Expand&gt;&gt;&gt;" Click="HLExpandContract_Click" Tag="expand" IsTabStop="False"></HyperlinkButton>

                                    <ScrollViewer Grid.Column="0" Grid.Row="4" HorizontalScrollBarVisibility="Disabled"  VerticalScrollBarVisibility="Auto">
                                        <ToolkitRef:WrapPanel x:Name="WPPaperTopics" Grid.Row="4" Grid.Column="0" Orientation="Horizontal">
                                            <TextBlock Margin="5,5,10,5" Text="Topics" FontStyle="Italic"></TextBlock>
                                            <HyperlinkButton Grid.Column="1" Content="Show selected (0)" Margin="0,5,5,5" HorizontalAlignment="Right" Width="105" IsTabStop="False"></HyperlinkButton>
                                        </ToolkitRef:WrapPanel>
                                    </ScrollViewer>

                                    <radDock:RadPaneGroup x:Name="CitationPane" Grid.Row="4" Grid.Column="1" TabStripPlacement="Top">
                                        <radDock:RadPane Header="References" Title="References" CanUserClose="False" CanFloat="False" CanUserPin="False" CanDockInDocumentHost="False" PaneHeaderVisibility="Collapsed">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*"></RowDefinition>
                                                    <RowDefinition Height="auto"></RowDefinition>
                                                </Grid.RowDefinitions>
                                                <telerikGridView:RadGridView x:Name="BibliographyGrid" Grid.Row="0" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding PagedSource, ElementName=BibliographyPager}"
                                    IsEnabled="{Binding Source={StaticResource CitationPaperListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed" CanUserSelect="False"
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                                    <telerikGridView:RadGridView.Columns>
                                                        <telerikGridView:GridViewDataColumn Header="" DataMemberBinding="{Binding FullRecord}">
                                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding FullRecord}" TextWrapping="Wrap" MouseLeftButtonUp="PaperListBibliographyGrid_MouseLeftButtonUp"/>
                                                                </DataTemplate>
                                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                                        </telerikGridView:GridViewDataColumn>
                                                        <telerikGridView:GridViewDataColumn IsFilterable="False" IsSortable="True" CellStyle="{StaticResource cellSelectedNotSelected}" Width="75" Header="" DataMemberBinding="{Binding IsSelected, Mode=TwoWay}"></telerikGridView:GridViewDataColumn>
                                                    </telerikGridView:RadGridView.Columns>
                                                </telerikGridView:RadGridView>

                                                <dpager:RadDataPager Grid.Row="1" x:Name="BibliographyPager" IsTotalItemCountFixed="True"
                DisplayMode="All" NumericButtonCount="10" Source="{Binding Source={StaticResource CitationPaperListData}, Path=Data}"
                PageIndexChanging="BibliographyPager_PageIndexChanging"></dpager:RadDataPager>

                                            </Grid>
                                        </radDock:RadPane>

                                        <radDock:RadPane Header="Cited by" CanUserClose="False" CanFloat="False">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*"></RowDefinition>
                                                    <RowDefinition Height="auto"></RowDefinition>
                                                </Grid.RowDefinitions>

                                                <telerikGridView:RadGridView x:Name="CitedByGrid" Grid.Row="0" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding PagedSource, ElementName=CitedByPager}"
                                    IsEnabled="{Binding Source={StaticResource CitedByListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed"
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                                    <telerikGridView:RadGridView.Columns>
                                                        <telerikGridView:GridViewDataColumn Header="" DataMemberBinding="{Binding FullRecord}">
                                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding FullRecord}" TextWrapping="Wrap" MouseLeftButtonUp="PaperListBibliographyGrid_MouseLeftButtonUp"/>
                                                                </DataTemplate>
                                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                                        </telerikGridView:GridViewDataColumn>
                                                        <telerikGridView:GridViewDataColumn IsFilterable="False" IsSortable="True" CellStyle="{StaticResource cellSelectedNotSelected}" Width="75" Header="" DataMemberBinding="{Binding IsSelected, Mode=TwoWay}"></telerikGridView:GridViewDataColumn>
                                                    </telerikGridView:RadGridView.Columns>
                                                </telerikGridView:RadGridView>

                                                <dpager:RadDataPager Grid.Row="1" x:Name="CitedByPager" IsTotalItemCountFixed="True"
                DisplayMode="All" NumericButtonCount="10" Source="{Binding Source={StaticResource CitedByListData}, Path=Data}"
                PageIndexChanging="CitedByPager_PageIndexChanging"></dpager:RadDataPager>

                                            </Grid>

                                        </radDock:RadPane>
                                        <radDock:RadPane Header="Related" CanUserClose="False" CanFloat="False">
                                            <telerikGridView:RadGridView x:Name="RelatedGrid" Grid.Column="1" Grid.Row="1" Grid.RowSpan="2" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding Source={StaticResource RecommendationsListData}, Path=Data, Mode=TwoWay}"
                                    IsEnabled="{Binding Source={StaticResource RecommendationsListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed"
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                                <telerikGridView:RadGridView.Columns>

                                                    <telerikGridView:GridViewDataColumn Header="" DataMemberBinding="{Binding FullRecord}">
                                                        <telerikGridView:GridViewDataColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock Text="{Binding FullRecord}" TextWrapping="Wrap" MouseLeftButtonUp="PaperListBibliographyGrid_MouseLeftButtonUp"/>
                                                            </DataTemplate>
                                                        </telerikGridView:GridViewDataColumn.CellTemplate>
                                                    </telerikGridView:GridViewDataColumn>
                                                    <telerikGridView:GridViewDataColumn IsFilterable="False" IsSortable="True" CellStyle="{StaticResource cellSelectedNotSelected}" Width="75" Header="" DataMemberBinding="{Binding IsSelected, Mode=TwoWay}"></telerikGridView:GridViewDataColumn>
                                                </telerikGridView:RadGridView.Columns>
                                            </telerikGridView:RadGridView>
                                            <!-- n.b. no data pager needed here, as there are only 20 related documents-->
                                        </radDock:RadPane>

                                    </radDock:RadPaneGroup>
                                </Grid>
                                <!-- End papergrid -->

                                <Grid x:Name="PaperListGrid" Grid.Row="1" Visibility="Collapsed">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="47"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="Auto"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="300"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock x:Name="TBPaperListTitle" FontSize="18" Text="" Grid.Row="0" Grid.ColumnSpan="2" Margin="5,20,5,5"></TextBlock>
                                    <ScrollViewer Grid.Column="0" Grid.Row="1" Grid.RowSpan="2" HorizontalScrollBarVisibility="Disabled"  VerticalScrollBarVisibility="Auto">
                                        <ToolkitRef:WrapPanel x:Name="WPTopTopics" ScrollViewer.VerticalScrollBarVisibility="Auto" Orientation="Horizontal">
                                            <TextBlock Margin="5,5,10,5" Text="Top Topics " FontStyle="Italic"></TextBlock>
                                            <HyperlinkButton Grid.Column="1" Content="Topic 1" Margin="0,5,5,5" HorizontalAlignment="Right" Width="105" IsTabStop="False"></HyperlinkButton>
                                        </ToolkitRef:WrapPanel>
                                    </ScrollViewer>

                                    <TextBlock x:Name="tbCountPaperListGrid" Grid.Row="0" Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="5,5,10,5"></TextBlock>
                                    <HyperlinkButton x:Name="lbSelectAllPapers" Content="Select all" Grid.Row="0" Grid.Column="1" Margin="5,5,250,5" HorizontalAlignment="Right" VerticalAlignment="Bottom" Click="lbSelectAllPapers_Click"  IsTabStop="False"></HyperlinkButton>

                                    <telerikGridView:RadGridView x:Name="PaperListBibliographyGrid" Grid.Column="1" Grid.Row="1" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding PagedSource, ElementName=PaperListBibliographyPager, Mode=TwoWay}"
                                    IsEnabled="{Binding Source={StaticResource PaperListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed"
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                        <telerikGridView:RadGridView.Columns>

                                            <telerikGridView:GridViewDataColumn DataMemberBinding="{Binding FullRecord}" Header="">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding FullRecord}" TextWrapping="Wrap" MouseLeftButtonUp="PaperListBibliographyGrid_MouseLeftButtonUp"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="50" UniqueName="SimilarityScoreColumn">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding SimilarityScore, StringFormat=N4}" MouseLeftButtonUp="PaperListBibliographyGrid_MouseLeftButtonUp" HorizontalAlignment="Center" VerticalAlignment="Top"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn IsFilterable="False" IsSortable="True" CellStyle="{StaticResource cellSelectedNotSelected}" Width="75" Header="" DataMemberBinding="{Binding IsSelected, Mode=TwoWay}"></telerikGridView:GridViewDataColumn>
                                        </telerikGridView:RadGridView.Columns>
                                    </telerikGridView:RadGridView>

                                    <dpager:RadDataPager Grid.Column="1" Grid.Row="3" x:Name="PaperListBibliographyPager" IsTotalItemCountFixed="True"
                DisplayMode="All" NumericButtonCount="10" Source="{Binding Source={StaticResource PaperListData}, Path=Data, Mode=TwoWay}"
                PageIndexChanging="PaperListBibliographyPager_PageIndexChanging"></dpager:RadDataPager>
                                </Grid>
                                <!-- end PaperListGrid -->

                                <Grid x:Name="TopicsGrid" Grid.Row="1" Visibility="Collapsed">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="50"></RowDefinition>
                                        <RowDefinition Height="auto"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="auto"></RowDefinition>
                                        <RowDefinition Height="40"></RowDefinition>
                                        <RowDefinition Height="40"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="300"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock x:Name="TBMainTopic" FontSize="18" Text="Topic" Grid.Row="0" Grid.ColumnSpan="2" Margin="5,5,5,5"></TextBlock>
                                    <TextBlock x:Name="tbCountTopicPaperListBibliographyGrid" Grid.Row="0" Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="5,5,10,5"></TextBlock>
                                    <HyperlinkButton x:Name="lbSelectAll" Content="Select all" Grid.Row="0" Grid.Column="1" Margin="5,5,250,5" HorizontalAlignment="Right" VerticalAlignment="Bottom" Click="lbSelectAll_Click" IsTabStop="False"></HyperlinkButton>

                                    <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Vertical">
                                        <ToolkitRef:WrapPanel x:Name="WPParentTopics" Orientation="Horizontal">
                                            <TextBlock Margin="5,5,10,5" Text="Parent Topics " FontStyle="Italic"></TextBlock>
                                            <HyperlinkButton Grid.Column="1" Content="Topic 1" Margin="0,5,5,5" HorizontalAlignment="Right" Width="105" IsTabStop="False"></HyperlinkButton>
                                        </ToolkitRef:WrapPanel>
                                    </StackPanel>

                                    <ScrollViewer Grid.Row="2" Grid.Column="0" HorizontalScrollBarVisibility="Disabled"  VerticalScrollBarVisibility="Auto">
                                        <ToolkitRef:WrapPanel x:Name="WPChildTopics" Orientation="Horizontal" Margin="0, 15, 0, 0">
                                            <TextBlock Margin="5,5,10,5" Text="Child Topics " FontStyle="Italic"></TextBlock>
                                            <HyperlinkButton Grid.Column="1" Content="Topic 1" Margin="0,5,5,5" HorizontalAlignment="Right" Width="105" IsTabStop="False"></HyperlinkButton>
                                        </ToolkitRef:WrapPanel>
                                    </ScrollViewer>

                                    <StackPanel Orientation="Horizontal" Grid.Row="4" Grid.Column="0">
                                        <TextBlock HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5" Text="After this date"></TextBlock>
                                        <telerik:RadDatePicker x:Name="datePickerFilterTopicPapersFrom" Grid.Row="4" Grid.Column="0" Margin="15,5,5,5" SelectionChanged="datePickerFilterTopics_SelectionChanged"></telerik:RadDatePicker>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal" Grid.Row="5" Grid.Column="0">
                                        <TextBlock HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5" Text="Before this date"></TextBlock>
                                        <telerik:RadDatePicker x:Name="datePickerFilterTopicPapersTo" Grid.Row="4" Grid.Column="0" Margin="5,5,5,5" SelectionChanged="datePickerFilterTopics_SelectionChanged"></telerik:RadDatePicker>
                                        <HyperlinkButton x:Name="hlRefreshTopicPaperListData" Content="Refresh" Margin="5,5,5,5" IsTabStop="False" Click="hlRefreshTopicPaperListData_Click" VerticalAlignment="Center" HorizontalAlignment="Center"></HyperlinkButton>
                                    </StackPanel>

                                    <telerikGridView:RadGridView x:Name="TopicPaperListBibliographyGrid" Grid.Column="1" Grid.Row="1" Grid.RowSpan="4" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding PagedSource, ElementName=TopicPaperListBibliographyPager}"
                                    IsEnabled="{Binding Source={StaticResource TopicPaperListData}, Converter={StaticResource ReverseBoolean}, Path=IsBusy }"
                                    RowIndicatorVisibility="Collapsed"
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                        <telerikGridView:RadGridView.Columns>
                                            <telerikGridView:GridViewDataColumn Header="" DataMemberBinding="{Binding FullRecord}">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding FullRecord}" TextWrapping="Wrap" MouseLeftButtonUp="PaperListBibliographyGrid_MouseLeftButtonUp"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn IsFilterable="False" IsSortable="True" CellStyle="{StaticResource cellSelectedNotSelected}" Width="75" Header="" DataMemberBinding="{Binding IsSelected, Mode=TwoWay}"></telerikGridView:GridViewDataColumn>
                                        </telerikGridView:RadGridView.Columns>
                                    </telerikGridView:RadGridView>

                                    <Grid Grid.Column="1" Grid.Row="5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"></ColumnDefinition>
                                            <ColumnDefinition Width="100"></ColumnDefinition>
                                        </Grid.ColumnDefinitions>
                                        <dpager:RadDataPager Grid.Column="0" Grid.Row="3" x:Name="TopicPaperListBibliographyPager" IsTotalItemCountFixed="True"
                DisplayMode="All"  NumericButtonCount="10" Source="{Binding Source={StaticResource TopicPaperListData}, Path=Data}"
                PageIndexChanging="TopicPaperListBibliographyPager_PageIndexChanging"></dpager:RadDataPager>

                                        <ComboBox x:Name="comboTopicPageSize" Grid.Column="1" Margin="5,5,5,6" SelectionChanged="comboTopicPageSize_SelectionChanged">
                                            <ComboBoxItem Content="20" FontSize="10" IsSelected="True" Tag="20"></ComboBoxItem>
                                            <ComboBoxItem Content="50" FontSize="10" Tag="50"></ComboBoxItem>
                                            <ComboBoxItem Content="100" FontSize="10" Tag="100"></ComboBoxItem>
                                        </ComboBox>

                                    </Grid>


                                </Grid>
                                <!-- end TopicsGrid -->

                                <HyperlinkButton x:Name="HLButtonBackToSearch" Content="Back to search" Click="HLButtonBackToSearch_Click" Background="AliceBlue" Opacity="50" IsTabStop="False" HorizontalAlignment="Right" VerticalAlignment="Top" Visibility="Collapsed"></HyperlinkButton>

                            </Grid>

                        </radDock:RadDocumentPane>
                        <!--= end search & browse -->

                        <radDock:RadDocumentPane x:Name="HistoryPane" Header="History" Title="History" CanFloat="False" CanUserClose="False" Tag="History">
                            <Grid x:Name="HistoryGrid" Background="Beige">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="40"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <HyperlinkButton x:Name="lbClearHistory" Margin="5,5,5,5" HorizontalAlignment="Center" VerticalAlignment="Center" Content="Clear History" Click="lbClearHistory_Click"></HyperlinkButton>


                                <telerikGridView:RadGridView x:Name="HistoryDataGrid" Grid.Row="1" AutoGenerateColumns="False" ShowGroupPanel="False"
                                    IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    ItemsSource="{Binding Source={StaticResource HistoryListData}, Path=Data, Mode=TwoWay}"
                                    RowIndicatorVisibility="Collapsed" CanUserSortColumns="False" 
                                    SelectionMode="Extended" ColumnWidth="*"
                                    IsSynchronizedWithCurrentItem="False">
                                    <telerikGridView:RadGridView.Columns>
                                        <telerikGridView:GridViewDataColumn Header="Pages browsed in order (earliest at the top)" DataMemberBinding="{Binding Title}"></telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Go!" Margin="10, 0, 10, 0" Click="HyperlinkButton_Click_1"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                        <telerikGridView:GridViewDataColumn Width="50" SortingState="None">
                                            <telerikGridView:GridViewDataColumn.CellTemplate>
                                                <DataTemplate>
                                                    <HyperlinkButton Content="Remove" Click="HyperlinkButton_Click"/>
                                                </DataTemplate>
                                            </telerikGridView:GridViewDataColumn.CellTemplate>
                                        </telerikGridView:GridViewDataColumn>
                                    </telerikGridView:RadGridView.Columns>
                                </telerikGridView:RadGridView>

                            </Grid>
                            <!-- end history grid -->

                        </radDock:RadDocumentPane>
                        <!-- end history -->

                        <radDock:RadDocumentPane x:Name="AdminPane" Header="Admin" Title="Admin" CanFloat="False" CanUserClose="False" Tag="Admin">
                            <Grid x:Name="AdminGrid" Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="500"></ColumnDefinition>
                                    <ColumnDefinition Width="20"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid x:Name="LHSGrid" Grid.Column="0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="200"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"></ColumnDefinition>
                                        <ColumnDefinition Width="400"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Latest MAG" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5,5,5,5"></TextBlock>
                                    <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="1">
                                        <TextBox x:Name="tbLatestMag" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5" IsReadOnly="False"></TextBox>
                                        <TextBlock Margin="5,5,5,5" Text="Previous MAG version:" VerticalAlignment="Center"></TextBlock>
                                        <TextBox x:Name="tbPreviousMAG" Margin="5,5,5,5" VerticalAlignment="Center"></TextBox>
                                    </StackPanel>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="SAS Key" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5,5,5,5"></TextBlock>
                                    <TextBox x:Name="tbMagSas" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5" IsReadOnly="True"></TextBox>
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Release notes" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="5,5,5,5"></TextBlock>
                                    <TextBox x:Name="tbReleaseNotes" Grid.Row="2" Grid.Column="1" Margin="5,5,5,5" IsReadOnly="True" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"></TextBox>

                                    <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
                                        <HyperlinkButton x:Name="hlAddMagReview" Content="Add this Review ID" Margin="5,5,5,5" Click="hlAddMagReview_Click"></HyperlinkButton>
                                        <TextBox x:Name="tbAddMagReview" Margin="5,5,5,5" Width="80"></TextBox>
                                        <HyperlinkButton Content="Refresh list" Margin="5,5,5,5" Click="HyperlinkButton_Click_7"></HyperlinkButton>
                                    </StackPanel>

                                    <telerikGridView:RadGridView x:Name="AdminDataGrid" Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" AutoGenerateColumns="True" ShowGroupPanel="False"
                                        IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                        ItemsSource="{Binding Source={StaticResource MagReviewListData}, Path=Data, Mode=TwoWay}"
                                        RowIndicatorVisibility="Collapsed" CanUserSortColumns="False" 
                                        SelectionMode="Extended" ColumnWidth="*"
                                        IsSynchronizedWithCurrentItem="False">
                                        <telerikGridView:RadGridView.Columns>

                                            <telerikGridView:GridViewDataColumn Width="50" SortingState="None">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="Delete" Click="HyperlinkButton_Click_6"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                        </telerikGridView:RadGridView.Columns>
                                    </telerikGridView:RadGridView>

                                    <StackPanel Grid.Row="5" Orientation="Vertical" Grid.ColumnSpan="2">
                                        <HyperlinkButton x:Name="LBUploadIDsFile" Content="Add IDs to selected items list" Click="LBUploadIDsFile_Click"  IsTabStop="False" Margin="0,10,5,5"></HyperlinkButton>
                                        <TextBox x:Name="TBUploadIDs" TextWrapping="Wrap" VerticalScrollBarVisibility="Visible" AcceptsReturn="True" MaxHeight="80"></TextBox>
                                    </StackPanel>
                                </Grid>
                                <!--end LHS Grid-->

                                <Grid x:Name="RHSGrid" Grid.Column="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="35"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                    </Grid.RowDefinitions>

                                    <StackPanel Grid.Row="0" Orientation="Horizontal">
                                        <HyperlinkButton x:Name="LBCurrentInfoCreate" Content="Add new MAG to MAKES list" Click="LBCurrentInfoCreate_Click"  Foreground="Red" IsTabStop="False" Margin="0,9,5,5" Visibility="Collapsed"></HyperlinkButton>
                                        <HyperlinkButton x:Name="LBCheckChangedPaperIds" Content="Identify ID changes BEFORE switching to new MAG" Click="CheckChangedPaperIds_Click" IsTabStop="False" Margin="0,9,5,5"></HyperlinkButton>
                                        <HyperlinkButton x:Name="LBDownloadNewPaperIds" Content="Download new PaperIds" Click="LBCreateParquetFiles_Click" IsTabStop="False" Margin="0,9,5,5" Tag="GetNewPaperIds"></HyperlinkButton>
                                        <HyperlinkButton x:Name="LBCreateParquetFiles" Content="Create parquet files for new MAG" Click="LBCreateParquetFiles_Click"  IsTabStop="False" Margin="5,9,5,5" Tag="Prepare parquet"></HyperlinkButton>
                                        <HyperlinkButton x:Name="LBGetMissingAbstracts" Content="Get missing abstracts for new MAG" Click="LBGetMissingAbstracts_Click" IsTabStop="False" Margin="5,9,5,5" Tag="Get abstracts that may not have been present when items first created"></HyperlinkButton>
                                    </StackPanel>
                                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                                        <HyperlinkButton x:Name="LBRunContReviewPipeline" Content="Run contreview pipeline" Click="LBRunContReviewPipeline_Click" IsTabStop="False" VerticalAlignment="Center"></HyperlinkButton>
                                        <TextBlock Margin="5,5,5,5" Text="Score threshold:" VerticalAlignment="Center"></TextBlock>
                                        <telerik:RadNumericUpDown x:Name="EditScoreThreshold" Minimum="0" Maximum="1" SmallChange="0.01" Value="0.2" Margin="3,5,5,5"></telerik:RadNumericUpDown>
                                        <TextBlock Margin="20,5,5,5" Text="FoS threshold:" VerticalAlignment="Center"></TextBlock>
                                        <telerik:RadNumericUpDown x:Name="EditFoSThreshold" Minimum="0" Maximum="1" SmallChange="0.05" Value="0" Margin="3,5,5,5"></telerik:RadNumericUpDown>
                                        <TextBlock Margin="20,5,5,5" Text="Sample size:" VerticalAlignment="Center"></TextBlock>
                                        <telerik:RadNumericUpDown x:Name="EditReviewSampleSize" Minimum="20" Maximum="4000" SmallChange="10" LargeChange="50" Value="200" Margin="3,5,5,5"></telerik:RadNumericUpDown>
                                    </StackPanel>

                                    <telerikGridView:RadGridView x:Name="MagCurrentInfoListGrid" Grid.Row="2" AutoGenerateColumns="False" ShowGroupPanel="False"
                                        IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                        ItemsSource="{Binding Source={StaticResource MagCurrentInfoListData}, Path=Data, Mode=TwoWay}"
                                        RowIndicatorVisibility="Collapsed" CanUserSortColumns="False" 
                                        SelectionMode="Extended" ColumnWidth="*"
                                        IsSynchronizedWithCurrentItem="False">
                                        <telerikGridView:RadGridView.Columns>
                                            <telerikGridView:GridViewDataColumn Header="Version" DataMemberBinding="{Binding MagFolder}" Width="100"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="When live" DataMemberBinding="{Binding WhenLive}" Width="120"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="Endpoint" DataMemberBinding="{Binding MakesEndPoint}" Width="*"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="Status" DataMemberBinding="{Binding MakesDeploymentStatus}" Width="80"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="80" SortingState="None" IsReadOnly="True" Header="Make live">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="Make live" Click="HyperlinkButton_Click_21"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="100" SortingState="None" IsReadOnly="True" Header="Make pending">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="Make pending" Click="HyperlinkButton_Click_22"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="70" SortingState="None" IsReadOnly="True" Header="Delete">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="Delete" Click="HyperlinkButton_Click_23"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                        </telerikGridView:RadGridView.Columns>
                                    </telerikGridView:RadGridView>

                                    <StackPanel Grid.Row="3" Orientation="Horizontal">
                                        <HyperlinkButton x:Name="LBSwitchOffAutoRefreshLogList" Content="Switch off auto refresh of table" Margin="5,5,5,2" VerticalAlignment="Bottom" Visibility="Collapsed" Click="LBSwitchOffAutoRefreshLogList_Click" IsTabStop="False"></HyperlinkButton>
                                        <HyperlinkButton x:Name="LBRefreshMagLogList" Content="Refresh log table" Margin="0,5,5,2" Click="LBRefreshMagLogList_Click" VerticalAlignment="Bottom" IsTabStop="False"></HyperlinkButton>
                                    </StackPanel>
                                    
                                    <telerikGridView:RadGridView x:Name="MagLogGrid" Grid.Row="4" AutoGenerateColumns="False" ShowGroupPanel="False"
                                        IsReadOnly="True" MinHeight="50" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                        ItemsSource="{Binding Source={StaticResource MagLogListData}, Path=Data, Mode=TwoWay}"
                                        RowIndicatorVisibility="Collapsed" CanUserSortColumns="False" 
                                        SelectionMode="Extended" ColumnWidth="*"
                                        IsSynchronizedWithCurrentItem="False">
                                        <telerikGridView:RadGridView.Columns>
                                            <telerikGridView:GridViewDataColumn Header="Job" DataMemberBinding="{Binding JobType}" Width="220"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="Submitted by" DataMemberBinding="{Binding ContactName}" Width="100"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Width="80" SortingState="None" IsReadOnly="True" Header="Job Status">
                                                <telerikGridView:GridViewDataColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <HyperlinkButton Content="{Binding JobStatus}" Click="HyperlinkButton_Click_13"/>
                                                    </DataTemplate>
                                                </telerikGridView:GridViewDataColumn.CellTemplate>
                                            </telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="When submitted" DataMemberBinding="{Binding TimeSubmitted}" Width="140"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="When updated" DataMemberBinding="{Binding TimeUpdated}" Width="140"></telerikGridView:GridViewDataColumn>
                                            <telerikGridView:GridViewDataColumn Header="Job message" DataMemberBinding="{Binding JobMessage}" Width="*"></telerikGridView:GridViewDataColumn>
                                        </telerikGridView:RadGridView.Columns>
                                    </telerikGridView:RadGridView>
                                    
                                </Grid>
                            </Grid>
                            <!--End Admin grid-->

                        </radDock:RadDocumentPane>
                        <!-- end admin -->

                    </radDock:RadPaneGroup>
            


                </radDock:RadSplitContainer>
            </radDock:RadDocking.DocumentHost>

        </radDock:RadDocking>
        <!-- end Related Papers grid (i.e. the current 'home page'-->


        

    </Grid>
</UserControl>